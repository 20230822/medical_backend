{"version":3,"file":"static/js/137.dc3b1351.chunk.js","mappings":"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","sources":["../node_modules/sdp/sdp.js","../node_modules/webrtc-adapter/src/js/utils.js","../node_modules/webrtc-adapter/src/js/chrome/getusermedia.js","../node_modules/webrtc-adapter/src/js/chrome/getdisplaymedia.js","../node_modules/webrtc-adapter/src/js/chrome/chrome_shim.js","../node_modules/webrtc-adapter/src/js/firefox/getusermedia.js","../node_modules/webrtc-adapter/src/js/firefox/getdisplaymedia.js","../node_modules/webrtc-adapter/src/js/firefox/firefox_shim.js","../node_modules/webrtc-adapter/src/js/safari/safari_shim.js","../node_modules/webrtc-adapter/src/js/common_shim.js","../node_modules/webrtc-adapter/src/js/adapter_factory.js","../node_modules/webrtc-adapter/src/js/adapter_core.js","../node_modules/engine.io-parser/build/esm/commons.js","../node_modules/engine.io-parser/build/esm/encodePacket.browser.js","../node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js","../node_modules/engine.io-parser/build/esm/decodePacket.browser.js","../node_modules/engine.io-parser/build/esm/index.js","../node_modules/@socket.io/component-emitter/index.mjs","../node_modules/engine.io-client/build/esm/globalThis.browser.js","../node_modules/engine.io-client/build/esm/util.js","../node_modules/engine.io-client/build/esm/transport.js","../node_modules/engine.io-client/build/esm/contrib/parseqs.js","../node_modules/engine.io-client/build/esm/contrib/yeast.js","../node_modules/engine.io-client/build/esm/contrib/has-cors.js","../node_modules/engine.io-client/build/esm/transports/xmlhttprequest.browser.js","../node_modules/engine.io-client/build/esm/transports/polling.js","../node_modules/engine.io-client/build/esm/transports/websocket-constructor.browser.js","../node_modules/engine.io-client/build/esm/transports/websocket.js","../node_modules/engine.io-client/build/esm/transports/index.js","../node_modules/engine.io-client/build/esm/transports/webtransport.js","../node_modules/engine.io-client/build/esm/contrib/parseuri.js","../node_modules/engine.io-client/build/esm/socket.js","../node_modules/engine.io-client/build/esm/index.js","../node_modules/socket.io-parser/build/esm/is-binary.js","../node_modules/socket.io-parser/build/esm/binary.js","../node_modules/socket.io-parser/build/esm/index.js","../node_modules/socket.io-client/build/esm/on.js","../node_modules/socket.io-client/build/esm/socket.js","../node_modules/socket.io-client/build/esm/contrib/backo2.js","../node_modules/socket.io-client/build/esm/manager.js","../node_modules/socket.io-client/build/esm/index.js","../node_modules/socket.io-client/build/esm/url.js"],"sourcesContent":["/* eslint-env node */\n'use strict';\n\n// SDP helpers.\nconst SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substring(2, 12);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(line => line.trim());\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  const parts = blob.split('\\nm=');\n  return parts.map((part, index) => (index > 0 ?\n    'm=' + part : part).trim() + '\\r\\n');\n};\n\n// Returns the session description.\nSDPUtils.getDescription = function(blob) {\n  const sections = SDPUtils.splitSections(blob);\n  return sections && sections[0];\n};\n\n// Returns the individual media sections.\nSDPUtils.getMediaSections = function(blob) {\n  const sections = SDPUtils.splitSections(blob);\n  sections.shift();\n  return sections;\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(line => line.indexOf(prefix) === 0);\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\n// Input can be prefixed with a=.\nSDPUtils.parseCandidate = function(line) {\n  let parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  const candidate = {\n    foundation: parts[0],\n    component: {1: 'rtp', 2: 'rtcp'}[parts[1]] || parts[1],\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    address: parts[4], // address is an alias for ip.\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7],\n  };\n\n  for (let i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compatibility.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag. Don't overwrite.\n        if (candidate[parts[i]] === undefined) {\n          candidate[parts[i]] = parts[i + 1];\n        }\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\n// This does not include the a= prefix!\nSDPUtils.writeCandidate = function(candidate) {\n  const sdp = [];\n  sdp.push(candidate.foundation);\n\n  const component = candidate.component;\n  if (component === 'rtp') {\n    sdp.push(1);\n  } else if (component === 'rtcp') {\n    sdp.push(2);\n  } else {\n    sdp.push(component);\n  }\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.address || candidate.ip);\n  sdp.push(candidate.port);\n\n  const type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress);\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort);\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.usernameFragment || candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.usernameFragment || candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// Sample input:\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substring(14).split(' ');\n};\n\n// Parses a rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  let parts = line.substring(9).split(' ');\n  const parsed = {\n    payloadType: parseInt(parts.shift(), 10), // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  // legacy alias, got renamed back to channels in ORTC.\n  parsed.numChannels = parsed.channels;\n  return parsed;\n};\n\n// Generates a rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  let pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  const channels = codec.channels || codec.numChannels || 1;\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (channels !== 1 ? '/' + channels : '') + '\\r\\n';\n};\n\n// Parses a extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  const parts = line.substring(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1],\n    attributes: parts.slice(2).join(' '),\n  };\n};\n\n// Generates an extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n        ? '/' + headerExtension.direction\n        : '') +\n      ' ' + headerExtension.uri +\n      (headerExtension.attributes ? ' ' + headerExtension.attributes : '') +\n      '\\r\\n';\n};\n\n// Parses a fmtp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  const parsed = {};\n  let kv;\n  const parts = line.substring(line.indexOf(' ') + 1).split(';');\n  for (let j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates a fmtp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  let line = '';\n  let pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    const params = [];\n    Object.keys(codec.parameters).forEach(param => {\n      if (codec.parameters[param] !== undefined) {\n        params.push(param + '=' + codec.parameters[param]);\n      } else {\n        params.push(param);\n      }\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses a rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  const parts = line.substring(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' '),\n  };\n};\n\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  let lines = '';\n  let pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(fb => {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses a RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  const sp = line.indexOf(' ');\n  const parts = {\n    ssrc: parseInt(line.substring(7, sp), 10),\n  };\n  const colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substring(sp + 1, colon);\n    parts.value = line.substring(colon + 1);\n  } else {\n    parts.attribute = line.substring(sp + 1);\n  }\n  return parts;\n};\n\n// Parse a ssrc-group line (see RFC 5576). Sample input:\n// a=ssrc-group:semantics 12 34\nSDPUtils.parseSsrcGroup = function(line) {\n  const parts = line.substring(13).split(' ');\n  return {\n    semantics: parts.shift(),\n    ssrcs: parts.map(ssrc => parseInt(ssrc, 10)),\n  };\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// Returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  const mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substring(6);\n  }\n};\n\n// Parses a fingerprint line for DTLS-SRTP.\nSDPUtils.parseFingerprint = function(line) {\n  const parts = line.substring(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1].toUpperCase(), // the definition is upper-case in RFC 4572.\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  const lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint),\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  let sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(fp => {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n\n// Parses a=crypto lines into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#dictionary-rtcsrtpsdesparameters-members\nSDPUtils.parseCryptoLine = function(line) {\n  const parts = line.substring(9).split(' ');\n  return {\n    tag: parseInt(parts[0], 10),\n    cryptoSuite: parts[1],\n    keyParams: parts[2],\n    sessionParams: parts.slice(3),\n  };\n};\n\nSDPUtils.writeCryptoLine = function(parameters) {\n  return 'a=crypto:' + parameters.tag + ' ' +\n    parameters.cryptoSuite + ' ' +\n    (typeof parameters.keyParams === 'object'\n      ? SDPUtils.writeCryptoKeyParams(parameters.keyParams)\n      : parameters.keyParams) +\n    (parameters.sessionParams ? ' ' + parameters.sessionParams.join(' ') : '') +\n    '\\r\\n';\n};\n\n// Parses the crypto key parameters into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#rtcsrtpkeyparam*\nSDPUtils.parseCryptoKeyParams = function(keyParams) {\n  if (keyParams.indexOf('inline:') !== 0) {\n    return null;\n  }\n  const parts = keyParams.substring(7).split('|');\n  return {\n    keyMethod: 'inline',\n    keySalt: parts[0],\n    lifeTime: parts[1],\n    mkiValue: parts[2] ? parts[2].split(':')[0] : undefined,\n    mkiLength: parts[2] ? parts[2].split(':')[1] : undefined,\n  };\n};\n\nSDPUtils.writeCryptoKeyParams = function(keyParams) {\n  return keyParams.keyMethod + ':'\n    + keyParams.keySalt +\n    (keyParams.lifeTime ? '|' + keyParams.lifeTime : '') +\n    (keyParams.mkiValue && keyParams.mkiLength\n      ? '|' + keyParams.mkiValue + ':' + keyParams.mkiLength\n      : '');\n};\n\n// Extracts all SDES parameters.\nSDPUtils.getCryptoParameters = function(mediaSection, sessionpart) {\n  const lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=crypto:');\n  return lines.map(SDPUtils.parseCryptoLine);\n};\n\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  const ufrag = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-ufrag:')[0];\n  const pwd = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-pwd:')[0];\n  if (!(ufrag && pwd)) {\n    return null;\n  }\n  return {\n    usernameFragment: ufrag.substring(12),\n    password: pwd.substring(10),\n  };\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  let sdp = 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n  if (params.iceLite) {\n    sdp += 'a=ice-lite\\r\\n';\n  }\n  return sdp;\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  const description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: [],\n  };\n  const lines = SDPUtils.splitLines(mediaSection);\n  const mline = lines[0].split(' ');\n  description.profile = mline[2];\n  for (let i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    const pt = mline[i];\n    const rtpmapline = SDPUtils.matchPrefix(\n      mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      const codec = SDPUtils.parseRtpMap(rtpmapline);\n      const fmtps = SDPUtils.matchPrefix(\n        mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(line => {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  const wildcardRtcpFb = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-fb:* ')\n    .map(SDPUtils.parseRtcpFb);\n  description.codecs.forEach(codec => {\n    wildcardRtcpFb.forEach(fb=> {\n      const duplicate = codec.rtcpFeedback.find(existingFeedback => {\n        return existingFeedback.type === fb.type &&\n          existingFeedback.parameter === fb.parameter;\n      });\n      if (!duplicate) {\n        codec.rtcpFeedback.push(fb);\n      }\n    });\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  let sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' ' + (caps.profile || 'UDP/TLS/RTP/SAVPF') + ' ';\n  sdp += caps.codecs.map(codec => {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(codec => {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  let maxptime = 0;\n  caps.codecs.forEach(codec => {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n\n  if (caps.headerExtensions) {\n    caps.headerExtensions.forEach(extension => {\n      sdp += SDPUtils.writeExtmap(extension);\n    });\n  }\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  const encodingParameters = [];\n  const description = SDPUtils.parseRtpParameters(mediaSection);\n  const hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  const hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  const ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(line => SDPUtils.parseSsrcMedia(line))\n    .filter(parts => parts.attribute === 'cname');\n  const primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  let secondarySsrc;\n\n  const flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n    .map(line => {\n      const parts = line.substring(17).split(' ');\n      return parts.map(part => parseInt(part, 10));\n    });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(codec => {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      let encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10),\n      };\n      if (primarySsrc && secondarySsrc) {\n        encParam.rtx = {ssrc: secondarySsrc};\n      }\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: primarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red',\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc,\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  let bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substring(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substring(5), 10) * 1000 * 0.95\n          - (50 * 40 * 8);\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(params => {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  const rtcpParameters = {};\n\n  // Gets the first SSRC. Note that with RTX there might be multiple\n  // SSRCs.\n  const remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(line => SDPUtils.parseSsrcMedia(line))\n    .filter(obj => obj.attribute === 'cname')[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  const rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrbute.\n  // Note that Edge does not support unmuxed RTCP.\n  const mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\nSDPUtils.writeRtcpParameters = function(rtcpParameters) {\n  let sdp = '';\n  if (rtcpParameters.reducedSize) {\n    sdp += 'a=rtcp-rsize\\r\\n';\n  }\n  if (rtcpParameters.mux) {\n    sdp += 'a=rtcp-mux\\r\\n';\n  }\n  if (rtcpParameters.ssrc !== undefined && rtcpParameters.cname) {\n    sdp += 'a=ssrc:' + rtcpParameters.ssrc +\n      ' cname:' + rtcpParameters.cname + '\\r\\n';\n  }\n  return sdp;\n};\n\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  let parts;\n  const spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substring(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  const planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(line => SDPUtils.parseSsrcMedia(line))\n    .filter(msidParts => msidParts.attribute === 'msid');\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\n// SCTP\n// parses draft-ietf-mmusic-sctp-sdp-26 first and falls back\n// to draft-ietf-mmusic-sctp-sdp-05\nSDPUtils.parseSctpDescription = function(mediaSection) {\n  const mline = SDPUtils.parseMLine(mediaSection);\n  const maxSizeLine = SDPUtils.matchPrefix(mediaSection, 'a=max-message-size:');\n  let maxMessageSize;\n  if (maxSizeLine.length > 0) {\n    maxMessageSize = parseInt(maxSizeLine[0].substring(19), 10);\n  }\n  if (isNaN(maxMessageSize)) {\n    maxMessageSize = 65536;\n  }\n  const sctpPort = SDPUtils.matchPrefix(mediaSection, 'a=sctp-port:');\n  if (sctpPort.length > 0) {\n    return {\n      port: parseInt(sctpPort[0].substring(12), 10),\n      protocol: mline.fmt,\n      maxMessageSize,\n    };\n  }\n  const sctpMapLines = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:');\n  if (sctpMapLines.length > 0) {\n    const parts = sctpMapLines[0]\n      .substring(10)\n      .split(' ');\n    return {\n      port: parseInt(parts[0], 10),\n      protocol: parts[1],\n      maxMessageSize,\n    };\n  }\n};\n\n// SCTP\n// outputs the draft-ietf-mmusic-sctp-sdp-26 version that all browsers\n// support by now receiving in this format, unless we originally parsed\n// as the draft-ietf-mmusic-sctp-sdp-05 format (indicated by the m-line\n// protocol of DTLS/SCTP -- without UDP/ or TCP/)\nSDPUtils.writeSctpDescription = function(media, sctp) {\n  let output = [];\n  if (media.protocol !== 'DTLS/SCTP') {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.protocol + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctp-port:' + sctp.port + '\\r\\n',\n    ];\n  } else {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.port + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctpmap:' + sctp.port + ' ' + sctp.protocol + ' 65535\\r\\n',\n    ];\n  }\n  if (sctp.maxMessageSize !== undefined) {\n    output.push('a=max-message-size:' + sctp.maxMessageSize + '\\r\\n');\n  }\n  return output.join('');\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function() {\n  return Math.random().toString().substr(2, 22);\n};\n\n// Write boiler plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\n// sessUser is optional and defaults to 'thisisadapterortc'\nSDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {\n  let sessionId;\n  const version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  const user = sessUser || 'thisisadapterortc';\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=' + user + ' ' + sessionId + ' ' + version +\n        ' IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  const lines = SDPUtils.splitLines(mediaSection);\n  for (let i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substring(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  const lines = SDPUtils.splitLines(mediaSection);\n  const mline = lines[0].split(' ');\n  return mline[0].substring(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function(mediaSection) {\n  const lines = SDPUtils.splitLines(mediaSection);\n  const parts = lines[0].substring(2).split(' ');\n  return {\n    kind: parts[0],\n    port: parseInt(parts[1], 10),\n    protocol: parts[2],\n    fmt: parts.slice(3).join(' '),\n  };\n};\n\nSDPUtils.parseOLine = function(mediaSection) {\n  const line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n  const parts = line.substring(2).split(' ');\n  return {\n    username: parts[0],\n    sessionId: parts[1],\n    sessionVersion: parseInt(parts[2], 10),\n    netType: parts[3],\n    addressType: parts[4],\n    address: parts[5],\n  };\n};\n\n// a very naive interpretation of a valid SDP.\nSDPUtils.isValidSDP = function(blob) {\n  if (typeof blob !== 'string' || blob.length === 0) {\n    return false;\n  }\n  const lines = SDPUtils.splitLines(blob);\n  for (let i = 0; i < lines.length; i++) {\n    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n      return false;\n    }\n    // TODO: check the modifier a bit more.\n  }\n  return true;\n};\n\n// Expose public methods.\nif (typeof module === 'object') {\n  module.exports = SDPUtils;\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nlet logDisabled_ = true;\nlet deprecationWarnings_ = true;\n\n/**\n * Extract browser version out of the provided user agent string.\n *\n * @param {!string} uastring userAgent string.\n * @param {!string} expr Regular expression used as match criteria.\n * @param {!number} pos position in the version string to be returned.\n * @return {!number} browser version.\n */\nexport function extractVersion(uastring, expr, pos) {\n  const match = uastring.match(expr);\n  return match && match.length >= pos && parseInt(match[pos], 10);\n}\n\n// Wraps the peerconnection event eventNameToWrap in a function\n// which returns the modified event object (or false to prevent\n// the event).\nexport function wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  const nativeAddEventListener = proto.addEventListener;\n  proto.addEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap) {\n      return nativeAddEventListener.apply(this, arguments);\n    }\n    const wrappedCallback = (e) => {\n      const modifiedEvent = wrapper(e);\n      if (modifiedEvent) {\n        if (cb.handleEvent) {\n          cb.handleEvent(modifiedEvent);\n        } else {\n          cb(modifiedEvent);\n        }\n      }\n    };\n    this._eventMap = this._eventMap || {};\n    if (!this._eventMap[eventNameToWrap]) {\n      this._eventMap[eventNameToWrap] = new Map();\n    }\n    this._eventMap[eventNameToWrap].set(cb, wrappedCallback);\n    return nativeAddEventListener.apply(this, [nativeEventName,\n      wrappedCallback]);\n  };\n\n  const nativeRemoveEventListener = proto.removeEventListener;\n  proto.removeEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap || !this._eventMap\n        || !this._eventMap[eventNameToWrap]) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    if (!this._eventMap[eventNameToWrap].has(cb)) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    const unwrappedCb = this._eventMap[eventNameToWrap].get(cb);\n    this._eventMap[eventNameToWrap].delete(cb);\n    if (this._eventMap[eventNameToWrap].size === 0) {\n      delete this._eventMap[eventNameToWrap];\n    }\n    if (Object.keys(this._eventMap).length === 0) {\n      delete this._eventMap;\n    }\n    return nativeRemoveEventListener.apply(this, [nativeEventName,\n      unwrappedCb]);\n  };\n\n  Object.defineProperty(proto, 'on' + eventNameToWrap, {\n    get() {\n      return this['_on' + eventNameToWrap];\n    },\n    set(cb) {\n      if (this['_on' + eventNameToWrap]) {\n        this.removeEventListener(eventNameToWrap,\n          this['_on' + eventNameToWrap]);\n        delete this['_on' + eventNameToWrap];\n      }\n      if (cb) {\n        this.addEventListener(eventNameToWrap,\n          this['_on' + eventNameToWrap] = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n}\n\nexport function disableLog(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  logDisabled_ = bool;\n  return (bool) ? 'adapter.js logging disabled' :\n    'adapter.js logging enabled';\n}\n\n/**\n * Disable or enable deprecation warnings\n * @param {!boolean} bool set to true to disable warnings.\n */\nexport function disableWarnings(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  deprecationWarnings_ = !bool;\n  return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\n}\n\nexport function log() {\n  if (typeof window === 'object') {\n    if (logDisabled_) {\n      return;\n    }\n    if (typeof console !== 'undefined' && typeof console.log === 'function') {\n      console.log.apply(console, arguments);\n    }\n  }\n}\n\n/**\n * Shows a deprecation warning suggesting the modern and spec-compatible API.\n */\nexport function deprecated(oldMethod, newMethod) {\n  if (!deprecationWarnings_) {\n    return;\n  }\n  console.warn(oldMethod + ' is deprecated, please use ' + newMethod +\n      ' instead.');\n}\n\n/**\n * Browser detector.\n *\n * @return {object} result containing browser and version\n *     properties.\n */\nexport function detectBrowser(window) {\n  // Returned result object.\n  const result = {browser: null, version: null};\n\n  // Fail early if it's not a browser\n  if (typeof window === 'undefined' || !window.navigator ||\n      !window.navigator.userAgent) {\n    result.browser = 'Not a browser.';\n    return result;\n  }\n\n  const {navigator} = window;\n\n  if (navigator.mozGetUserMedia) { // Firefox.\n    result.browser = 'firefox';\n    result.version = extractVersion(navigator.userAgent,\n      /Firefox\\/(\\d+)\\./, 1);\n  } else if (navigator.webkitGetUserMedia ||\n      (window.isSecureContext === false && window.webkitRTCPeerConnection)) {\n    // Chrome, Chromium, Webview, Opera.\n    // Version matches Chrome/WebRTC version.\n    // Chrome 74 removed webkitGetUserMedia on http as well so we need the\n    // more complicated fallback to webkitRTCPeerConnection.\n    result.browser = 'chrome';\n    result.version = extractVersion(navigator.userAgent,\n      /Chrom(e|ium)\\/(\\d+)\\./, 2);\n  } else if (window.RTCPeerConnection &&\n      navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) { // Safari.\n    result.browser = 'safari';\n    result.version = extractVersion(navigator.userAgent,\n      /AppleWebKit\\/(\\d+)\\./, 1);\n    result.supportsUnifiedPlan = window.RTCRtpTransceiver &&\n        'currentDirection' in window.RTCRtpTransceiver.prototype;\n  } else { // Default fallthrough: not supported.\n    result.browser = 'Not a supported browser.';\n    return result;\n  }\n\n  return result;\n}\n\n/**\n * Checks if something is an object.\n *\n * @param {*} val The something you want to check.\n * @return true if val is an object, false otherwise.\n */\nfunction isObject(val) {\n  return Object.prototype.toString.call(val) === '[object Object]';\n}\n\n/**\n * Remove all empty objects and undefined values\n * from a nested object -- an enhanced and vanilla version\n * of Lodash's `compact`.\n */\nexport function compactObject(data) {\n  if (!isObject(data)) {\n    return data;\n  }\n\n  return Object.keys(data).reduce(function(accumulator, key) {\n    const isObj = isObject(data[key]);\n    const value = isObj ? compactObject(data[key]) : data[key];\n    const isEmptyObject = isObj && !Object.keys(value).length;\n    if (value === undefined || isEmptyObject) {\n      return accumulator;\n    }\n    return Object.assign(accumulator, {[key]: value});\n  }, {});\n}\n\n/* iterates the stats graph recursively. */\nexport function walkStats(stats, base, resultSet) {\n  if (!base || resultSet.has(base.id)) {\n    return;\n  }\n  resultSet.set(base.id, base);\n  Object.keys(base).forEach(name => {\n    if (name.endsWith('Id')) {\n      walkStats(stats, stats.get(base[name]), resultSet);\n    } else if (name.endsWith('Ids')) {\n      base[name].forEach(id => {\n        walkStats(stats, stats.get(id), resultSet);\n      });\n    }\n  });\n}\n\n/* filter getStats for a sender/receiver track. */\nexport function filterStats(result, track, outbound) {\n  const streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\n  const filteredResult = new Map();\n  if (track === null) {\n    return filteredResult;\n  }\n  const trackStats = [];\n  result.forEach(value => {\n    if (value.type === 'track' &&\n        value.trackIdentifier === track.id) {\n      trackStats.push(value);\n    }\n  });\n  trackStats.forEach(trackStat => {\n    result.forEach(stats => {\n      if (stats.type === streamStatsType && stats.trackId === trackStat.id) {\n        walkStats(result, stats, filteredResult);\n      }\n    });\n  });\n  return filteredResult;\n}\n\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\nconst logging = utils.log;\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n\n  if (!navigator.mediaDevices) {\n    return;\n  }\n\n  const constraintsToChrome_ = function(c) {\n    if (typeof c !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    const cc = {};\n    Object.keys(c).forEach(key => {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      const r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      const oldname_ = function(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return (name === 'deviceId') ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        let oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(mix => {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  const shimConstraints_ = function(constraints, func) {\n    if (browserDetails.version >= 61) {\n      return func(constraints);\n    }\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && typeof constraints.audio === 'object') {\n      const remap = function(obj, a, b) {\n        if (a in obj && !(b in obj)) {\n          obj[b] = obj[a];\n          delete obj[a];\n        }\n      };\n      constraints = JSON.parse(JSON.stringify(constraints));\n      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && typeof constraints.video === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      let face = constraints.video.facingMode;\n      face = face && ((typeof face === 'object') ? face : {ideal: face});\n      const getSupportedFacingModeLies = browserDetails.version < 66;\n\n      if ((face && (face.exact === 'user' || face.exact === 'environment' ||\n                    face.ideal === 'user' || face.ideal === 'environment')) &&\n          !(navigator.mediaDevices.getSupportedConstraints &&\n            navigator.mediaDevices.getSupportedConstraints().facingMode &&\n            !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        let matches;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices()\n            .then(devices => {\n              devices = devices.filter(d => d.kind === 'videoinput');\n              let dev = devices.find(d => matches.some(match =>\n                d.label.toLowerCase().includes(match)));\n              if (!dev && devices.length && matches.includes('back')) {\n                dev = devices[devices.length - 1]; // more likely the back cam\n              }\n              if (dev) {\n                constraints.video.deviceId = face.exact\n                  ? {exact: dev.deviceId}\n                  : {ideal: dev.deviceId};\n              }\n              constraints.video = constraintsToChrome_(constraints.video);\n              logging('chrome: ' + JSON.stringify(constraints));\n              return func(constraints);\n            });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  const shimError_ = function(e) {\n    if (browserDetails.version >= 64) {\n      return e;\n    }\n    return {\n      name: {\n        PermissionDeniedError: 'NotAllowedError',\n        PermissionDismissedError: 'NotAllowedError',\n        InvalidStateError: 'NotAllowedError',\n        DevicesNotFoundError: 'NotFoundError',\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        TrackStartError: 'NotReadableError',\n        MediaDeviceFailedDueToShutdown: 'NotAllowedError',\n        MediaDeviceKillSwitchOn: 'NotAllowedError',\n        TabCaptureError: 'AbortError',\n        ScreenCaptureError: 'AbortError',\n        DeviceCaptureError: 'AbortError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint || e.constraintName,\n      toString() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  const getUserMedia_ = function(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, c => {\n      navigator.webkitGetUserMedia(c, onSuccess, e => {\n        if (onError) {\n          onError(shimError_(e));\n        }\n      });\n    });\n  };\n  navigator.getUserMedia = getUserMedia_.bind(navigator);\n\n  // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n  // function which returns a Promise, it does not accept spec-style\n  // constraints.\n  if (navigator.mediaDevices.getUserMedia) {\n    const origGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(cs) {\n      return shimConstraints_(cs, c => origGetUserMedia(c).then(stream => {\n        if (c.audio && !stream.getAudioTracks().length ||\n            c.video && !stream.getVideoTracks().length) {\n          stream.getTracks().forEach(track => {\n            track.stop();\n          });\n          throw new DOMException('', 'NotFoundError');\n        }\n        return stream;\n      }, e => Promise.reject(shimError_(e))));\n    };\n  }\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nexport function shimGetDisplayMedia(window, getSourceId) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  // getSourceId is a function that returns a promise resolving with\n  // the sourceId of the screen/window/tab to be shared.\n  if (typeof getSourceId !== 'function') {\n    console.error('shimGetDisplayMedia: getSourceId argument is not ' +\n        'a function');\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      return getSourceId(constraints)\n        .then(sourceId => {\n          const widthSpecified = constraints.video && constraints.video.width;\n          const heightSpecified = constraints.video &&\n            constraints.video.height;\n          const frameRateSpecified = constraints.video &&\n            constraints.video.frameRate;\n          constraints.video = {\n            mandatory: {\n              chromeMediaSource: 'desktop',\n              chromeMediaSourceId: sourceId,\n              maxFrameRate: frameRateSpecified || 3\n            }\n          };\n          if (widthSpecified) {\n            constraints.video.mandatory.maxWidth = widthSpecified;\n          }\n          if (heightSpecified) {\n            constraints.video.mandatory.maxHeight = heightSpecified;\n          }\n          return window.navigator.mediaDevices.getUserMedia(constraints);\n        });\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\n\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimMediaStream(window) {\n  window.MediaStream = window.MediaStream || window.webkitMediaStream;\n}\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n      window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n      get() {\n        return this._ontrack;\n      },\n      set(f) {\n        if (this._ontrack) {\n          this.removeEventListener('track', this._ontrack);\n        }\n        this.addEventListener('track', this._ontrack = f);\n      },\n      enumerable: true,\n      configurable: true\n    });\n    const origSetRemoteDescription =\n        window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        if (!this._ontrackpoly) {\n          this._ontrackpoly = (e) => {\n            // onaddstream does not fire when a track is added to an existing\n            // stream. But stream.onaddtrack is implemented so we use that.\n            e.stream.addEventListener('addtrack', te => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === te.track.id);\n              } else {\n                receiver = {track: te.track};\n              }\n\n              const event = new Event('track');\n              event.track = te.track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n            e.stream.getTracks().forEach(track => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === track.id);\n              } else {\n                receiver = {track};\n              }\n              const event = new Event('track');\n              event.track = track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n          };\n          this.addEventListener('addstream', this._ontrackpoly);\n        }\n        return origSetRemoteDescription.apply(this, arguments);\n      };\n  } else {\n    // even if RTCRtpTransceiver is in window, it is only used and\n    // emitted in unified-plan. Unfortunately this means we need\n    // to unconditionally wrap the event.\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      if (!e.transceiver) {\n        Object.defineProperty(e, 'transceiver',\n          {value: {receiver: e.receiver}});\n      }\n      return e;\n    });\n  }\n}\n\nexport function shimGetSendersWithDtmf(window) {\n  // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n  if (typeof window === 'object' && window.RTCPeerConnection &&\n      !('getSenders' in window.RTCPeerConnection.prototype) &&\n      'createDTMFSender' in window.RTCPeerConnection.prototype) {\n    const shimSenderWithDtmf = function(pc, track) {\n      return {\n        track,\n        get dtmf() {\n          if (this._dtmf === undefined) {\n            if (track.kind === 'audio') {\n              this._dtmf = pc.createDTMFSender(track);\n            } else {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        },\n        _pc: pc\n      };\n    };\n\n    // augment addTrack when getSenders is not available.\n    if (!window.RTCPeerConnection.prototype.getSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        this._senders = this._senders || [];\n        return this._senders.slice(); // return a copy of the internal state.\n      };\n      const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addTrack =\n        function addTrack(track, stream) {\n          let sender = origAddTrack.apply(this, arguments);\n          if (!sender) {\n            sender = shimSenderWithDtmf(this, track);\n            this._senders.push(sender);\n          }\n          return sender;\n        };\n\n      const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n      window.RTCPeerConnection.prototype.removeTrack =\n        function removeTrack(sender) {\n          origRemoveTrack.apply(this, arguments);\n          const idx = this._senders.indexOf(sender);\n          if (idx !== -1) {\n            this._senders.splice(idx, 1);\n          }\n        };\n    }\n    const origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      this._senders = this._senders || [];\n      origAddStream.apply(this, [stream]);\n      stream.getTracks().forEach(track => {\n        this._senders.push(shimSenderWithDtmf(this, track));\n      });\n    };\n\n    const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        this._senders = this._senders || [];\n        origRemoveStream.apply(this, [stream]);\n\n        stream.getTracks().forEach(track => {\n          const sender = this._senders.find(s => s.track === track);\n          if (sender) { // remove sender\n            this._senders.splice(this._senders.indexOf(sender), 1);\n          }\n        });\n      };\n  } else if (typeof window === 'object' && window.RTCPeerConnection &&\n             'getSenders' in window.RTCPeerConnection.prototype &&\n             'createDTMFSender' in window.RTCPeerConnection.prototype &&\n             window.RTCRtpSender &&\n             !('dtmf' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = this._pc.createDTMFSender(this.track);\n          } else {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n}\n\nexport function shimGetStats(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n\n    // If selector is a function then we are in the old style stats so just\n    // pass back the original getStats format to avoid breaking old users.\n    if (arguments.length > 0 && typeof selector === 'function') {\n      return origGetStats.apply(this, arguments);\n    }\n\n    // When spec-style getStats is supported, return those when called with\n    // either no arguments or the selector argument is null.\n    if (origGetStats.length === 0 && (arguments.length === 0 ||\n        typeof selector !== 'function')) {\n      return origGetStats.apply(this, []);\n    }\n\n    const fixChromeStats_ = function(response) {\n      const standardReport = {};\n      const reports = response.result();\n      reports.forEach(report => {\n        const standardStats = {\n          id: report.id,\n          timestamp: report.timestamp,\n          type: {\n            localcandidate: 'local-candidate',\n            remotecandidate: 'remote-candidate'\n          }[report.type] || report.type\n        };\n        report.names().forEach(name => {\n          standardStats[name] = report.stat(name);\n        });\n        standardReport[standardStats.id] = standardStats;\n      });\n\n      return standardReport;\n    };\n\n    // shim getStats with maplike support\n    const makeMapStats = function(stats) {\n      return new Map(Object.keys(stats).map(key => [key, stats[key]]));\n    };\n\n    if (arguments.length >= 2) {\n      const successCallbackWrapper_ = function(response) {\n        onSucc(makeMapStats(fixChromeStats_(response)));\n      };\n\n      return origGetStats.apply(this, [successCallbackWrapper_,\n        selector]);\n    }\n\n    // promise-support\n    return new Promise((resolve, reject) => {\n      origGetStats.apply(this, [\n        function(response) {\n          resolve(makeMapStats(fixChromeStats_(response)));\n        }, reject]);\n    }).then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender && window.RTCRtpReceiver)) {\n    return;\n  }\n\n  // shim sender stats.\n  if (!('getStats' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    if (origGetSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        const senders = origGetSenders.apply(this, []);\n        senders.forEach(sender => sender._pc = this);\n        return senders;\n      };\n    }\n\n    const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    if (origAddTrack) {\n      window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n        const sender = origAddTrack.apply(this, arguments);\n        sender._pc = this;\n        return sender;\n      };\n    }\n    window.RTCRtpSender.prototype.getStats = function getStats() {\n      const sender = this;\n      return this._pc.getStats().then(result =>\n        /* Note: this will include stats of all senders that\n         *   send a track with the same id as sender.track as\n         *   it is not possible to identify the RTCRtpSender.\n         */\n        utils.filterStats(result, sender.track, true));\n    };\n  }\n\n  // shim receiver stats.\n  if (!('getStats' in window.RTCRtpReceiver.prototype)) {\n    const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n    if (origGetReceivers) {\n      window.RTCPeerConnection.prototype.getReceivers =\n        function getReceivers() {\n          const receivers = origGetReceivers.apply(this, []);\n          receivers.forEach(receiver => receiver._pc = this);\n          return receivers;\n        };\n    }\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      e.receiver._pc = e.srcElement;\n      return e;\n    });\n    window.RTCRtpReceiver.prototype.getStats = function getStats() {\n      const receiver = this;\n      return this._pc.getStats().then(result =>\n        utils.filterStats(result, receiver.track, false));\n    };\n  }\n\n  if (!('getStats' in window.RTCRtpSender.prototype &&\n      'getStats' in window.RTCRtpReceiver.prototype)) {\n    return;\n  }\n\n  // shim RTCPeerConnection.getStats(track).\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    if (arguments.length > 0 &&\n        arguments[0] instanceof window.MediaStreamTrack) {\n      const track = arguments[0];\n      let sender;\n      let receiver;\n      let err;\n      this.getSenders().forEach(s => {\n        if (s.track === track) {\n          if (sender) {\n            err = true;\n          } else {\n            sender = s;\n          }\n        }\n      });\n      this.getReceivers().forEach(r => {\n        if (r.track === track) {\n          if (receiver) {\n            err = true;\n          } else {\n            receiver = r;\n          }\n        }\n        return r.track === track;\n      });\n      if (err || (sender && receiver)) {\n        return Promise.reject(new DOMException(\n          'There are more than one sender or receiver for the track.',\n          'InvalidAccessError'));\n      } else if (sender) {\n        return sender.getStats();\n      } else if (receiver) {\n        return receiver.getStats();\n      }\n      return Promise.reject(new DOMException(\n        'There is no sender or receiver for the track.',\n        'InvalidAccessError'));\n    }\n    return origGetStats.apply(this, arguments);\n  };\n}\n\nexport function shimAddTrackRemoveTrackWithNative(window) {\n  // shim addTrack/removeTrack with native variants in order to make\n  // the interactions with legacy getLocalStreams behave as in other browsers.\n  // Keeps a mapping stream.id => [stream, rtpsenders...]\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      return Object.keys(this._shimmedLocalStreams)\n        .map(streamId => this._shimmedLocalStreams[streamId][0]);\n    };\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (!stream) {\n        return origAddTrack.apply(this, arguments);\n      }\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n      const sender = origAddTrack.apply(this, arguments);\n      if (!this._shimmedLocalStreams[stream.id]) {\n        this._shimmedLocalStreams[stream.id] = [stream, sender];\n      } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\n        this._shimmedLocalStreams[stream.id].push(sender);\n      }\n      return sender;\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n          'InvalidAccessError');\n      }\n    });\n    const existingSenders = this.getSenders();\n    origAddStream.apply(this, arguments);\n    const newSenders = this.getSenders()\n      .filter(newSender => existingSenders.indexOf(newSender) === -1);\n    this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      delete this._shimmedLocalStreams[stream.id];\n      return origRemoveStream.apply(this, arguments);\n    };\n\n  const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      if (sender) {\n        Object.keys(this._shimmedLocalStreams).forEach(streamId => {\n          const idx = this._shimmedLocalStreams[streamId].indexOf(sender);\n          if (idx !== -1) {\n            this._shimmedLocalStreams[streamId].splice(idx, 1);\n          }\n          if (this._shimmedLocalStreams[streamId].length === 1) {\n            delete this._shimmedLocalStreams[streamId];\n          }\n        });\n      }\n      return origRemoveTrack.apply(this, arguments);\n    };\n}\n\nexport function shimAddTrackRemoveTrack(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // shim addTrack and removeTrack.\n  if (window.RTCPeerConnection.prototype.addTrack &&\n      browserDetails.version >= 65) {\n    return shimAddTrackRemoveTrackWithNative(window);\n  }\n\n  // also shim pc.getLocalStreams when addTrack is shimmed\n  // to return the original streams.\n  const origGetLocalStreams = window.RTCPeerConnection.prototype\n    .getLocalStreams;\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      const nativeStreams = origGetLocalStreams.apply(this);\n      this._reverseStreams = this._reverseStreams || {};\n      return nativeStreams.map(stream => this._reverseStreams[stream.id]);\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n          'InvalidAccessError');\n      }\n    });\n    // Add identity mapping for consistency with addTrack.\n    // Unless this is being used with a stream from addTrack.\n    if (!this._reverseStreams[stream.id]) {\n      const newStream = new window.MediaStream(stream.getTracks());\n      this._streams[stream.id] = newStream;\n      this._reverseStreams[newStream.id] = stream;\n      stream = newStream;\n    }\n    origAddStream.apply(this, [stream]);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n\n      origRemoveStream.apply(this, [(this._streams[stream.id] || stream)]);\n      delete this._reverseStreams[(this._streams[stream.id] ?\n        this._streams[stream.id].id : stream.id)];\n      delete this._streams[stream.id];\n    };\n\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      const streams = [].slice.call(arguments, 1);\n      if (streams.length !== 1 ||\n          !streams[0].getTracks().find(t => t === track)) {\n        // this is not fully correct but all we can manage without\n        // [[associated MediaStreams]] internal slot.\n        throw new DOMException(\n          'The adapter.js addTrack polyfill only supports a single ' +\n          ' stream which is associated with the specified track.',\n          'NotSupportedError');\n      }\n\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n          'InvalidAccessError');\n      }\n\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n      const oldStream = this._streams[stream.id];\n      if (oldStream) {\n        // this is using odd Chrome behaviour, use with caution:\n        // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n        // Note: we rely on the high-level addTrack/dtmf shim to\n        // create the sender with a dtmf sender.\n        oldStream.addTrack(track);\n\n        // Trigger ONN async.\n        Promise.resolve().then(() => {\n          this.dispatchEvent(new Event('negotiationneeded'));\n        });\n      } else {\n        const newStream = new window.MediaStream([track]);\n        this._streams[stream.id] = newStream;\n        this._reverseStreams[newStream.id] = stream;\n        this.addStream(newStream);\n      }\n      return this.getSenders().find(s => s.track === track);\n    };\n\n  // replace the internal stream id with the external one and\n  // vice versa.\n  function replaceInternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(internalStream.id, 'g'),\n        externalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  function replaceExternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(externalStream.id, 'g'),\n        internalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  ['createOffer', 'createAnswer'].forEach(function(method) {\n    const nativeMethod = window.RTCPeerConnection.prototype[method];\n    const methodObj = {[method]() {\n      const args = arguments;\n      const isLegacyCall = arguments.length &&\n          typeof arguments[0] === 'function';\n      if (isLegacyCall) {\n        return nativeMethod.apply(this, [\n          (description) => {\n            const desc = replaceInternalStreamId(this, description);\n            args[0].apply(null, [desc]);\n          },\n          (err) => {\n            if (args[1]) {\n              args[1].apply(null, err);\n            }\n          }, arguments[2]\n        ]);\n      }\n      return nativeMethod.apply(this, arguments)\n        .then(description => replaceInternalStreamId(this, description));\n    }};\n    window.RTCPeerConnection.prototype[method] = methodObj[method];\n  });\n\n  const origSetLocalDescription =\n      window.RTCPeerConnection.prototype.setLocalDescription;\n  window.RTCPeerConnection.prototype.setLocalDescription =\n    function setLocalDescription() {\n      if (!arguments.length || !arguments[0].type) {\n        return origSetLocalDescription.apply(this, arguments);\n      }\n      arguments[0] = replaceExternalStreamId(this, arguments[0]);\n      return origSetLocalDescription.apply(this, arguments);\n    };\n\n  // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n  const origLocalDescription = Object.getOwnPropertyDescriptor(\n    window.RTCPeerConnection.prototype, 'localDescription');\n  Object.defineProperty(window.RTCPeerConnection.prototype,\n    'localDescription', {\n      get() {\n        const description = origLocalDescription.get.apply(this);\n        if (description.type === '') {\n          return description;\n        }\n        return replaceInternalStreamId(this, description);\n      }\n    });\n\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      // We can not yet check for sender instanceof RTCRtpSender\n      // since we shim RTPSender. So we check if sender._pc is set.\n      if (!sender._pc) {\n        throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' +\n            'does not implement interface RTCRtpSender.', 'TypeError');\n      }\n      const isLocal = sender._pc === this;\n      if (!isLocal) {\n        throw new DOMException('Sender was not created by this connection.',\n          'InvalidAccessError');\n      }\n\n      // Search for the native stream the senders track belongs to.\n      this._streams = this._streams || {};\n      let stream;\n      Object.keys(this._streams).forEach(streamid => {\n        const hasTrack = this._streams[streamid].getTracks()\n          .find(track => sender.track === track);\n        if (hasTrack) {\n          stream = this._streams[streamid];\n        }\n      });\n\n      if (stream) {\n        if (stream.getTracks().length === 1) {\n          // if this is the last track of the stream, remove the stream. This\n          // takes care of any shimmed _senders.\n          this.removeStream(this._reverseStreams[stream.id]);\n        } else {\n          // relying on the same odd chrome behaviour as above.\n          stream.removeTrack(sender.track);\n        }\n        this.dispatchEvent(new Event('negotiationneeded'));\n      }\n    };\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.webkitRTCPeerConnection;\n  }\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n  if (browserDetails.version < 53) {\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n      .forEach(function(method) {\n        const nativeMethod = window.RTCPeerConnection.prototype[method];\n        const methodObj = {[method]() {\n          arguments[0] = new ((method === 'addIceCandidate') ?\n            window.RTCIceCandidate :\n            window.RTCSessionDescription)(arguments[0]);\n          return nativeMethod.apply(this, arguments);\n        }};\n        window.RTCPeerConnection.prototype[method] = methodObj[method];\n      });\n  }\n}\n\n// Attempt to fix ONN in plan-b mode.\nexport function fixNegotiationNeeded(window, browserDetails) {\n  utils.wrapPeerConnectionEvent(window, 'negotiationneeded', e => {\n    const pc = e.target;\n    if (browserDetails.version < 72 || (pc.getConfiguration &&\n        pc.getConfiguration().sdpSemantics === 'plan-b')) {\n      if (pc.signalingState !== 'stable') {\n        return;\n      }\n    }\n    return e;\n  });\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n  const MediaStreamTrack = window && window.MediaStreamTrack;\n\n  navigator.getUserMedia = function(constraints, onSuccess, onError) {\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    utils.deprecated('navigator.getUserMedia',\n      'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n\n  if (!(browserDetails.version > 55 &&\n      'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n    const remap = function(obj, a, b) {\n      if (a in obj && !(b in obj)) {\n        obj[b] = obj[a];\n        delete obj[a];\n      }\n    };\n\n    const nativeGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      if (typeof c === 'object' && typeof c.audio === 'object') {\n        c = JSON.parse(JSON.stringify(c));\n        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n      }\n      return nativeGetUserMedia(c);\n    };\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n      const nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n      MediaStreamTrack.prototype.getSettings = function() {\n        const obj = nativeGetSettings.apply(this, arguments);\n        remap(obj, 'mozAutoGainControl', 'autoGainControl');\n        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n        return obj;\n      };\n    }\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n      const nativeApplyConstraints =\n        MediaStreamTrack.prototype.applyConstraints;\n      MediaStreamTrack.prototype.applyConstraints = function(c) {\n        if (this.kind === 'audio' && typeof c === 'object') {\n          c = JSON.parse(JSON.stringify(c));\n          remap(c, 'autoGainControl', 'mozAutoGainControl');\n          remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n        }\n        return nativeApplyConstraints.apply(this, [c]);\n      };\n    }\n  }\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nexport function shimGetDisplayMedia(window, preferredMediaSource) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      if (!(constraints && constraints.video)) {\n        const err = new DOMException('getDisplayMedia without video ' +\n            'constraints is undefined');\n        err.name = 'NotFoundError';\n        // from https://heycam.github.io/webidl/#idl-DOMException-error-names\n        err.code = 8;\n        return Promise.reject(err);\n      }\n      if (constraints.video === true) {\n        constraints.video = {mediaSource: preferredMediaSource};\n      } else {\n        constraints.video.mediaSource = preferredMediaSource;\n      }\n      return window.navigator.mediaDevices.getUserMedia(constraints);\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      ('receiver' in window.RTCTrackEvent.prototype) &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (typeof window !== 'object' ||\n      !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\n    return; // probably media.peerconnection.enabled=false in about:config\n  }\n  if (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.mozRTCPeerConnection;\n  }\n\n  if (browserDetails.version < 53) {\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n      .forEach(function(method) {\n        const nativeMethod = window.RTCPeerConnection.prototype[method];\n        const methodObj = {[method]() {\n          arguments[0] = new ((method === 'addIceCandidate') ?\n            window.RTCIceCandidate :\n            window.RTCSessionDescription)(arguments[0]);\n          return nativeMethod.apply(this, arguments);\n        }};\n        window.RTCPeerConnection.prototype[method] = methodObj[method];\n      });\n  }\n\n  const modernStatsTypes = {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  };\n\n  const nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n    return nativeGetStats.apply(this, [selector || null])\n      .then(stats => {\n        if (browserDetails.version < 53 && !onSucc) {\n          // Shim only promise getStats with spec-hyphens in type names\n          // Leave callback version alone; misc old uses of forEach before Map\n          try {\n            stats.forEach(stat => {\n              stat.type = modernStatsTypes[stat.type] || stat.type;\n            });\n          } catch (e) {\n            if (e.name !== 'TypeError') {\n              throw e;\n            }\n            // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n            stats.forEach((stat, i) => {\n              stats.set(i, Object.assign({}, stat, {\n                type: modernStatsTypes[stat.type] || stat.type\n              }));\n            });\n          }\n        }\n        return stats;\n      })\n      .then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n    return;\n  }\n  const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n  if (origGetSenders) {\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n  }\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  if (origAddTrack) {\n    window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n      const sender = origAddTrack.apply(this, arguments);\n      sender._pc = this;\n      return sender;\n    };\n  }\n  window.RTCRtpSender.prototype.getStats = function getStats() {\n    return this.track ? this._pc.getStats(this.track) :\n      Promise.resolve(new Map());\n  };\n}\n\nexport function shimReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n    return;\n  }\n  const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n  if (origGetReceivers) {\n    window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n      const receivers = origGetReceivers.apply(this, []);\n      receivers.forEach(receiver => receiver._pc = this);\n      return receivers;\n    };\n  }\n  utils.wrapPeerConnectionEvent(window, 'track', e => {\n    e.receiver._pc = e.srcElement;\n    return e;\n  });\n  window.RTCRtpReceiver.prototype.getStats = function getStats() {\n    return this._pc.getStats(this.track);\n  };\n}\n\nexport function shimRemoveStream(window) {\n  if (!window.RTCPeerConnection ||\n      'removeStream' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      utils.deprecated('removeStream', 'removeTrack');\n      this.getSenders().forEach(sender => {\n        if (sender.track && stream.getTracks().includes(sender.track)) {\n          this.removeTrack(sender);\n        }\n      });\n    };\n}\n\nexport function shimRTCDataChannel(window) {\n  // rename DataChannel to RTCDataChannel (native fix in FF60):\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n  if (window.DataChannel && !window.RTCDataChannel) {\n    window.RTCDataChannel = window.DataChannel;\n  }\n}\n\nexport function shimAddTransceiver(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origAddTransceiver = window.RTCPeerConnection.prototype.addTransceiver;\n  if (origAddTransceiver) {\n    window.RTCPeerConnection.prototype.addTransceiver =\n      function addTransceiver() {\n        this.setParametersPromises = [];\n        // WebIDL input coercion and validation\n        let sendEncodings = arguments[1] && arguments[1].sendEncodings;\n        if (sendEncodings === undefined) {\n          sendEncodings = [];\n        }\n        sendEncodings = [...sendEncodings];\n        const shouldPerformCheck = sendEncodings.length > 0;\n        if (shouldPerformCheck) {\n          // If sendEncodings params are provided, validate grammar\n          sendEncodings.forEach((encodingParam) => {\n            if ('rid' in encodingParam) {\n              const ridRegex = /^[a-z0-9]{0,16}$/i;\n              if (!ridRegex.test(encodingParam.rid)) {\n                throw new TypeError('Invalid RID value provided.');\n              }\n            }\n            if ('scaleResolutionDownBy' in encodingParam) {\n              if (!(parseFloat(encodingParam.scaleResolutionDownBy) >= 1.0)) {\n                throw new RangeError('scale_resolution_down_by must be >= 1.0');\n              }\n            }\n            if ('maxFramerate' in encodingParam) {\n              if (!(parseFloat(encodingParam.maxFramerate) >= 0)) {\n                throw new RangeError('max_framerate must be >= 0.0');\n              }\n            }\n          });\n        }\n        const transceiver = origAddTransceiver.apply(this, arguments);\n        if (shouldPerformCheck) {\n          // Check if the init options were applied. If not we do this in an\n          // asynchronous way and save the promise reference in a global object.\n          // This is an ugly hack, but at the same time is way more robust than\n          // checking the sender parameters before and after the createOffer\n          // Also note that after the createoffer we are not 100% sure that\n          // the params were asynchronously applied so we might miss the\n          // opportunity to recreate offer.\n          const {sender} = transceiver;\n          const params = sender.getParameters();\n          if (!('encodings' in params) ||\n              // Avoid being fooled by patched getParameters() below.\n              (params.encodings.length === 1 &&\n               Object.keys(params.encodings[0]).length === 0)) {\n            params.encodings = sendEncodings;\n            sender.sendEncodings = sendEncodings;\n            this.setParametersPromises.push(sender.setParameters(params)\n              .then(() => {\n                delete sender.sendEncodings;\n              }).catch(() => {\n                delete sender.sendEncodings;\n              })\n            );\n          }\n        }\n        return transceiver;\n      };\n  }\n}\n\nexport function shimGetParameters(window) {\n  if (!(typeof window === 'object' && window.RTCRtpSender)) {\n    return;\n  }\n  const origGetParameters = window.RTCRtpSender.prototype.getParameters;\n  if (origGetParameters) {\n    window.RTCRtpSender.prototype.getParameters =\n      function getParameters() {\n        const params = origGetParameters.apply(this, arguments);\n        if (!('encodings' in params)) {\n          params.encodings = [].concat(this.sendEncodings || [{}]);\n        }\n        return params;\n      };\n  }\n}\n\nexport function shimCreateOffer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer = function createOffer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n        .then(() => {\n          return origCreateOffer.apply(this, arguments);\n        })\n        .finally(() => {\n          this.setParametersPromises = [];\n        });\n    }\n    return origCreateOffer.apply(this, arguments);\n  };\n}\n\nexport function shimCreateAnswer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateAnswer = window.RTCPeerConnection.prototype.createAnswer;\n  window.RTCPeerConnection.prototype.createAnswer = function createAnswer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n        .then(() => {\n          return origCreateAnswer.apply(this, arguments);\n        })\n        .finally(() => {\n          this.setParametersPromises = [];\n        });\n    }\n    return origCreateAnswer.apply(this, arguments);\n  };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\nimport * as utils from '../utils';\n\nexport function shimLocalStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getLocalStreams =\n      function getLocalStreams() {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        return this._localStreams;\n      };\n  }\n  if (!('addStream' in window.RTCPeerConnection.prototype)) {\n    const _addTrack = window.RTCPeerConnection.prototype.addTrack;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      if (!this._localStreams.includes(stream)) {\n        this._localStreams.push(stream);\n      }\n      // Try to emulate Chrome's behaviour of adding in audio-video order.\n      // Safari orders by track id.\n      stream.getAudioTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n      stream.getVideoTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n    };\n\n    window.RTCPeerConnection.prototype.addTrack =\n      function addTrack(track, ...streams) {\n        if (streams) {\n          streams.forEach((stream) => {\n            if (!this._localStreams) {\n              this._localStreams = [stream];\n            } else if (!this._localStreams.includes(stream)) {\n              this._localStreams.push(stream);\n            }\n          });\n        }\n        return _addTrack.apply(this, arguments);\n      };\n  }\n  if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        const index = this._localStreams.indexOf(stream);\n        if (index === -1) {\n          return;\n        }\n        this._localStreams.splice(index, 1);\n        const tracks = stream.getTracks();\n        this.getSenders().forEach(sender => {\n          if (tracks.includes(sender.track)) {\n            this.removeTrack(sender);\n          }\n        });\n      };\n  }\n}\n\nexport function shimRemoteStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getRemoteStreams =\n      function getRemoteStreams() {\n        return this._remoteStreams ? this._remoteStreams : [];\n      };\n  }\n  if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n      get() {\n        return this._onaddstream;\n      },\n      set(f) {\n        if (this._onaddstream) {\n          this.removeEventListener('addstream', this._onaddstream);\n          this.removeEventListener('track', this._onaddstreampoly);\n        }\n        this.addEventListener('addstream', this._onaddstream = f);\n        this.addEventListener('track', this._onaddstreampoly = (e) => {\n          e.streams.forEach(stream => {\n            if (!this._remoteStreams) {\n              this._remoteStreams = [];\n            }\n            if (this._remoteStreams.includes(stream)) {\n              return;\n            }\n            this._remoteStreams.push(stream);\n            const event = new Event('addstream');\n            event.stream = stream;\n            this.dispatchEvent(event);\n          });\n        });\n      }\n    });\n    const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        const pc = this;\n        if (!this._onaddstreampoly) {\n          this.addEventListener('track', this._onaddstreampoly = function(e) {\n            e.streams.forEach(stream => {\n              if (!pc._remoteStreams) {\n                pc._remoteStreams = [];\n              }\n              if (pc._remoteStreams.indexOf(stream) >= 0) {\n                return;\n              }\n              pc._remoteStreams.push(stream);\n              const event = new Event('addstream');\n              event.stream = stream;\n              pc.dispatchEvent(event);\n            });\n          });\n        }\n        return origSetRemoteDescription.apply(pc, arguments);\n      };\n  }\n}\n\nexport function shimCallbacksAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  const prototype = window.RTCPeerConnection.prototype;\n  const origCreateOffer = prototype.createOffer;\n  const origCreateAnswer = prototype.createAnswer;\n  const setLocalDescription = prototype.setLocalDescription;\n  const setRemoteDescription = prototype.setRemoteDescription;\n  const addIceCandidate = prototype.addIceCandidate;\n\n  prototype.createOffer =\n    function createOffer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateOffer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  prototype.createAnswer =\n    function createAnswer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateAnswer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  let withCallback = function(description, successCallback, failureCallback) {\n    const promise = setLocalDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setLocalDescription = withCallback;\n\n  withCallback = function(description, successCallback, failureCallback) {\n    const promise = setRemoteDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setRemoteDescription = withCallback;\n\n  withCallback = function(candidate, successCallback, failureCallback) {\n    const promise = addIceCandidate.apply(this, [candidate]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.addIceCandidate = withCallback;\n}\n\nexport function shimGetUserMedia(window) {\n  const navigator = window && window.navigator;\n\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    // shim not needed in Safari 12.1\n    const mediaDevices = navigator.mediaDevices;\n    const _getUserMedia = mediaDevices.getUserMedia.bind(mediaDevices);\n    navigator.mediaDevices.getUserMedia = (constraints) => {\n      return _getUserMedia(shimConstraints(constraints));\n    };\n  }\n\n  if (!navigator.getUserMedia && navigator.mediaDevices &&\n    navigator.mediaDevices.getUserMedia) {\n    navigator.getUserMedia = function getUserMedia(constraints, cb, errcb) {\n      navigator.mediaDevices.getUserMedia(constraints)\n        .then(cb, errcb);\n    }.bind(navigator);\n  }\n}\n\nexport function shimConstraints(constraints) {\n  if (constraints && constraints.video !== undefined) {\n    return Object.assign({},\n      constraints,\n      {video: utils.compactObject(constraints.video)}\n    );\n  }\n\n  return constraints;\n}\n\nexport function shimRTCIceServerUrls(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n  const OrigPeerConnection = window.RTCPeerConnection;\n  window.RTCPeerConnection =\n    function RTCPeerConnection(pcConfig, pcConstraints) {\n      if (pcConfig && pcConfig.iceServers) {\n        const newIceServers = [];\n        for (let i = 0; i < pcConfig.iceServers.length; i++) {\n          let server = pcConfig.iceServers[i];\n          if (server.urls === undefined && server.url) {\n            utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n            server = JSON.parse(JSON.stringify(server));\n            server.urls = server.url;\n            delete server.url;\n            newIceServers.push(server);\n          } else {\n            newIceServers.push(pcConfig.iceServers[i]);\n          }\n        }\n        pcConfig.iceServers = newIceServers;\n      }\n      return new OrigPeerConnection(pcConfig, pcConstraints);\n    };\n  window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n  // wrap static methods. Currently just generateCertificate.\n  if ('generateCertificate' in OrigPeerConnection) {\n    Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n      get() {\n        return OrigPeerConnection.generateCertificate;\n      }\n    });\n  }\n}\n\nexport function shimTrackEventTransceiver(window) {\n  // Add event.transceiver member over deprecated event.receiver\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      'receiver' in window.RTCTrackEvent.prototype &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimCreateOfferLegacy(window) {\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer =\n    function createOffer(offerOptions) {\n      if (offerOptions) {\n        if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveAudio =\n            !!offerOptions.offerToReceiveAudio;\n        }\n        const audioTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'audio');\n        if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n          if (audioTransceiver.direction === 'sendrecv') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('sendonly');\n            } else {\n              audioTransceiver.direction = 'sendonly';\n            }\n          } else if (audioTransceiver.direction === 'recvonly') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('inactive');\n            } else {\n              audioTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveAudio === true &&\n            !audioTransceiver) {\n          this.addTransceiver('audio', {direction: 'recvonly'});\n        }\n\n        if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveVideo =\n            !!offerOptions.offerToReceiveVideo;\n        }\n        const videoTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'video');\n        if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n          if (videoTransceiver.direction === 'sendrecv') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('sendonly');\n            } else {\n              videoTransceiver.direction = 'sendonly';\n            }\n          } else if (videoTransceiver.direction === 'recvonly') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('inactive');\n            } else {\n              videoTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveVideo === true &&\n            !videoTransceiver) {\n          this.addTransceiver('video', {direction: 'recvonly'});\n        }\n      }\n      return origCreateOffer.apply(this, arguments);\n    };\n}\n\nexport function shimAudioContext(window) {\n  if (typeof window !== 'object' || window.AudioContext) {\n    return;\n  }\n  window.AudioContext = window.webkitAudioContext;\n}\n\n","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport SDPUtils from 'sdp';\nimport * as utils from './utils';\n\nexport function shimRTCIceCandidate(window) {\n  // foundation is arbitrarily chosen as an indicator for full support for\n  // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n  if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'foundation' in\n      window.RTCIceCandidate.prototype)) {\n    return;\n  }\n\n  const NativeRTCIceCandidate = window.RTCIceCandidate;\n  window.RTCIceCandidate = function RTCIceCandidate(args) {\n    // Remove the a= which shouldn't be part of the candidate string.\n    if (typeof args === 'object' && args.candidate &&\n        args.candidate.indexOf('a=') === 0) {\n      args = JSON.parse(JSON.stringify(args));\n      args.candidate = args.candidate.substring(2);\n    }\n\n    if (args.candidate && args.candidate.length) {\n      // Augment the native candidate with the parsed fields.\n      const nativeCandidate = new NativeRTCIceCandidate(args);\n      const parsedCandidate = SDPUtils.parseCandidate(args.candidate);\n      for (const key in parsedCandidate) {\n        if (!(key in nativeCandidate)) {\n          Object.defineProperty(nativeCandidate, key,\n            {value: parsedCandidate[key]});\n        }\n      }\n\n      // Override serializer to not serialize the extra attributes.\n      nativeCandidate.toJSON = function toJSON() {\n        return {\n          candidate: nativeCandidate.candidate,\n          sdpMid: nativeCandidate.sdpMid,\n          sdpMLineIndex: nativeCandidate.sdpMLineIndex,\n          usernameFragment: nativeCandidate.usernameFragment,\n        };\n      };\n      return nativeCandidate;\n    }\n    return new NativeRTCIceCandidate(args);\n  };\n  window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', e => {\n    if (e.candidate) {\n      Object.defineProperty(e, 'candidate', {\n        value: new window.RTCIceCandidate(e.candidate),\n        writable: 'false'\n      });\n    }\n    return e;\n  });\n}\n\nexport function shimRTCIceCandidateRelayProtocol(window) {\n  if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'relayProtocol' in\n      window.RTCIceCandidate.prototype)) {\n    return;\n  }\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', e => {\n    if (e.candidate) {\n      const parsedCandidate = SDPUtils.parseCandidate(e.candidate.candidate);\n      if (parsedCandidate.type === 'relay') {\n        // This is a libwebrtc-specific mapping of local type preference\n        // to relayProtocol.\n        e.candidate.relayProtocol = {\n          0: 'tls',\n          1: 'tcp',\n          2: 'udp',\n        }[parsedCandidate.priority >> 24];\n      }\n    }\n    return e;\n  });\n}\n\nexport function shimMaxMessageSize(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  if (!('sctp' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\n      get() {\n        return typeof this._sctp === 'undefined' ? null : this._sctp;\n      }\n    });\n  }\n\n  const sctpInDescription = function(description) {\n    if (!description || !description.sdp) {\n      return false;\n    }\n    const sections = SDPUtils.splitSections(description.sdp);\n    sections.shift();\n    return sections.some(mediaSection => {\n      const mLine = SDPUtils.parseMLine(mediaSection);\n      return mLine && mLine.kind === 'application'\n          && mLine.protocol.indexOf('SCTP') !== -1;\n    });\n  };\n\n  const getRemoteFirefoxVersion = function(description) {\n    // TODO: Is there a better solution for detecting Firefox?\n    const match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\n    if (match === null || match.length < 2) {\n      return -1;\n    }\n    const version = parseInt(match[1], 10);\n    // Test for NaN (yes, this is ugly)\n    return version !== version ? -1 : version;\n  };\n\n  const getCanSendMaxMessageSize = function(remoteIsFirefox) {\n    // Every implementation we know can send at least 64 KiB.\n    // Note: Although Chrome is technically able to send up to 256 KiB, the\n    //       data does not reach the other peer reliably.\n    //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\n    let canSendMaxMessageSize = 65536;\n    if (browserDetails.browser === 'firefox') {\n      if (browserDetails.version < 57) {\n        if (remoteIsFirefox === -1) {\n          // FF < 57 will send in 16 KiB chunks using the deprecated PPID\n          // fragmentation.\n          canSendMaxMessageSize = 16384;\n        } else {\n          // However, other FF (and RAWRTC) can reassemble PPID-fragmented\n          // messages. Thus, supporting ~2 GiB when sending.\n          canSendMaxMessageSize = 2147483637;\n        }\n      } else if (browserDetails.version < 60) {\n        // Currently, all FF >= 57 will reset the remote maximum message size\n        // to the default value when a data channel is created at a later\n        // stage. :(\n        // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n        canSendMaxMessageSize =\n          browserDetails.version === 57 ? 65535 : 65536;\n      } else {\n        // FF >= 60 supports sending ~2 GiB\n        canSendMaxMessageSize = 2147483637;\n      }\n    }\n    return canSendMaxMessageSize;\n  };\n\n  const getMaxMessageSize = function(description, remoteIsFirefox) {\n    // Note: 65536 bytes is the default value from the SDP spec. Also,\n    //       every implementation we know supports receiving 65536 bytes.\n    let maxMessageSize = 65536;\n\n    // FF 57 has a slightly incorrect default remote max message size, so\n    // we need to adjust it here to avoid a failure when sending.\n    // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\n    if (browserDetails.browser === 'firefox'\n         && browserDetails.version === 57) {\n      maxMessageSize = 65535;\n    }\n\n    const match = SDPUtils.matchPrefix(description.sdp,\n      'a=max-message-size:');\n    if (match.length > 0) {\n      maxMessageSize = parseInt(match[0].substring(19), 10);\n    } else if (browserDetails.browser === 'firefox' &&\n                remoteIsFirefox !== -1) {\n      // If the maximum message size is not present in the remote SDP and\n      // both local and remote are Firefox, the remote peer can receive\n      // ~2 GiB.\n      maxMessageSize = 2147483637;\n    }\n    return maxMessageSize;\n  };\n\n  const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n    function setRemoteDescription() {\n      this._sctp = null;\n      // Chrome decided to not expose .sctp in plan-b mode.\n      // As usual, adapter.js has to do an 'ugly worakaround'\n      // to cover up the mess.\n      if (browserDetails.browser === 'chrome' && browserDetails.version >= 76) {\n        const {sdpSemantics} = this.getConfiguration();\n        if (sdpSemantics === 'plan-b') {\n          Object.defineProperty(this, 'sctp', {\n            get() {\n              return typeof this._sctp === 'undefined' ? null : this._sctp;\n            },\n            enumerable: true,\n            configurable: true,\n          });\n        }\n      }\n\n      if (sctpInDescription(arguments[0])) {\n        // Check if the remote is FF.\n        const isFirefox = getRemoteFirefoxVersion(arguments[0]);\n\n        // Get the maximum message size the local peer is capable of sending\n        const canSendMMS = getCanSendMaxMessageSize(isFirefox);\n\n        // Get the maximum message size of the remote peer.\n        const remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\n\n        // Determine final maximum message size\n        let maxMessageSize;\n        if (canSendMMS === 0 && remoteMMS === 0) {\n          maxMessageSize = Number.POSITIVE_INFINITY;\n        } else if (canSendMMS === 0 || remoteMMS === 0) {\n          maxMessageSize = Math.max(canSendMMS, remoteMMS);\n        } else {\n          maxMessageSize = Math.min(canSendMMS, remoteMMS);\n        }\n\n        // Create a dummy RTCSctpTransport object and the 'maxMessageSize'\n        // attribute.\n        const sctp = {};\n        Object.defineProperty(sctp, 'maxMessageSize', {\n          get() {\n            return maxMessageSize;\n          }\n        });\n        this._sctp = sctp;\n      }\n\n      return origSetRemoteDescription.apply(this, arguments);\n    };\n}\n\nexport function shimSendThrowTypeError(window) {\n  if (!(window.RTCPeerConnection &&\n      'createDataChannel' in window.RTCPeerConnection.prototype)) {\n    return;\n  }\n\n  // Note: Although Firefox >= 57 has a native implementation, the maximum\n  //       message size can be reset for all data channels at a later stage.\n  //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n\n  function wrapDcSend(dc, pc) {\n    const origDataChannelSend = dc.send;\n    dc.send = function send() {\n      const data = arguments[0];\n      const length = data.length || data.size || data.byteLength;\n      if (dc.readyState === 'open' &&\n          pc.sctp && length > pc.sctp.maxMessageSize) {\n        throw new TypeError('Message too large (can send a maximum of ' +\n          pc.sctp.maxMessageSize + ' bytes)');\n      }\n      return origDataChannelSend.apply(dc, arguments);\n    };\n  }\n  const origCreateDataChannel =\n    window.RTCPeerConnection.prototype.createDataChannel;\n  window.RTCPeerConnection.prototype.createDataChannel =\n    function createDataChannel() {\n      const dataChannel = origCreateDataChannel.apply(this, arguments);\n      wrapDcSend(dataChannel, this);\n      return dataChannel;\n    };\n  utils.wrapPeerConnectionEvent(window, 'datachannel', e => {\n    wrapDcSend(e.channel, e.target);\n    return e;\n  });\n}\n\n\n/* shims RTCConnectionState by pretending it is the same as iceConnectionState.\n * See https://bugs.chromium.org/p/webrtc/issues/detail?id=6145#c12\n * for why this is a valid hack in Chrome. In Firefox it is slightly incorrect\n * since DTLS failures would be hidden. See\n * https://bugzilla.mozilla.org/show_bug.cgi?id=1265827\n * for the Firefox tracking bug.\n */\nexport function shimConnectionState(window) {\n  if (!window.RTCPeerConnection ||\n      'connectionState' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  Object.defineProperty(proto, 'connectionState', {\n    get() {\n      return {\n        completed: 'connected',\n        checking: 'connecting'\n      }[this.iceConnectionState] || this.iceConnectionState;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(proto, 'onconnectionstatechange', {\n    get() {\n      return this._onconnectionstatechange || null;\n    },\n    set(cb) {\n      if (this._onconnectionstatechange) {\n        this.removeEventListener('connectionstatechange',\n          this._onconnectionstatechange);\n        delete this._onconnectionstatechange;\n      }\n      if (cb) {\n        this.addEventListener('connectionstatechange',\n          this._onconnectionstatechange = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  ['setLocalDescription', 'setRemoteDescription'].forEach((method) => {\n    const origMethod = proto[method];\n    proto[method] = function() {\n      if (!this._connectionstatechangepoly) {\n        this._connectionstatechangepoly = e => {\n          const pc = e.target;\n          if (pc._lastConnectionState !== pc.connectionState) {\n            pc._lastConnectionState = pc.connectionState;\n            const newEvent = new Event('connectionstatechange', e);\n            pc.dispatchEvent(newEvent);\n          }\n          return e;\n        };\n        this.addEventListener('iceconnectionstatechange',\n          this._connectionstatechangepoly);\n      }\n      return origMethod.apply(this, arguments);\n    };\n  });\n}\n\nexport function removeExtmapAllowMixed(window, browserDetails) {\n  /* remove a=extmap-allow-mixed for webrtc.org < M71 */\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  if (browserDetails.browser === 'chrome' && browserDetails.version >= 71) {\n    return;\n  }\n  if (browserDetails.browser === 'safari' && browserDetails.version >= 605) {\n    return;\n  }\n  const nativeSRD = window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n  function setRemoteDescription(desc) {\n    if (desc && desc.sdp && desc.sdp.indexOf('\\na=extmap-allow-mixed') !== -1) {\n      const sdp = desc.sdp.split('\\n').filter((line) => {\n        return line.trim() !== 'a=extmap-allow-mixed';\n      }).join('\\n');\n      // Safari enforces read-only-ness of RTCSessionDescription fields.\n      if (window.RTCSessionDescription &&\n          desc instanceof window.RTCSessionDescription) {\n        arguments[0] = new window.RTCSessionDescription({\n          type: desc.type,\n          sdp,\n        });\n      } else {\n        desc.sdp = sdp;\n      }\n    }\n    return nativeSRD.apply(this, arguments);\n  };\n}\n\nexport function shimAddIceCandidateNullOrEmpty(window, browserDetails) {\n  // Support for addIceCandidate(null or undefined)\n  // as well as addIceCandidate({candidate: \"\", ...})\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=978582\n  // Note: must be called before other polyfills which change the signature.\n  if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n    return;\n  }\n  const nativeAddIceCandidate =\n      window.RTCPeerConnection.prototype.addIceCandidate;\n  if (!nativeAddIceCandidate || nativeAddIceCandidate.length === 0) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.addIceCandidate =\n    function addIceCandidate() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      // Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\n      // in older versions.\n      // Native support for ignoring exists for Chrome M77+.\n      // Safari ignores as well, exact version unknown but works in the same\n      // version that also ignores addIceCandidate(null).\n      if (((browserDetails.browser === 'chrome' && browserDetails.version < 78)\n           || (browserDetails.browser === 'firefox'\n               && browserDetails.version < 68)\n           || (browserDetails.browser === 'safari'))\n          && arguments[0] && arguments[0].candidate === '') {\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n}\n\n// Note: Make sure to call this ahead of APIs that modify\n// setLocalDescription.length\nexport function shimParameterlessSetLocalDescription(window, browserDetails) {\n  if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n    return;\n  }\n  const nativeSetLocalDescription =\n      window.RTCPeerConnection.prototype.setLocalDescription;\n  if (!nativeSetLocalDescription || nativeSetLocalDescription.length === 0) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.setLocalDescription =\n    function setLocalDescription() {\n      let desc = arguments[0] || {};\n      if (typeof desc !== 'object' || (desc.type && desc.sdp)) {\n        return nativeSetLocalDescription.apply(this, arguments);\n      }\n      // The remaining steps should technically happen when SLD comes off the\n      // RTCPeerConnection's operations chain (not ahead of going on it), but\n      // this is too difficult to shim. Instead, this shim only covers the\n      // common case where the operations chain is empty. This is imperfect, but\n      // should cover many cases. Rationale: Even if we can't reduce the glare\n      // window to zero on imperfect implementations, there's value in tapping\n      // into the perfect negotiation pattern that several browsers support.\n      desc = {type: desc.type, sdp: desc.sdp};\n      if (!desc.type) {\n        switch (this.signalingState) {\n          case 'stable':\n          case 'have-local-offer':\n          case 'have-remote-pranswer':\n            desc.type = 'offer';\n            break;\n          default:\n            desc.type = 'answer';\n            break;\n        }\n      }\n      if (desc.sdp || (desc.type !== 'offer' && desc.type !== 'answer')) {\n        return nativeSetLocalDescription.apply(this, [desc]);\n      }\n      const func = desc.type === 'offer' ? this.createOffer : this.createAnswer;\n      return func.apply(this)\n        .then(d => nativeSetLocalDescription.apply(this, [d]));\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\nimport * as utils from './utils';\n\n// Browser shims.\nimport * as chromeShim from './chrome/chrome_shim';\nimport * as firefoxShim from './firefox/firefox_shim';\nimport * as safariShim from './safari/safari_shim';\nimport * as commonShim from './common_shim';\nimport * as sdp from 'sdp';\n\n// Shimming starts here.\nexport function adapterFactory({window} = {}, options = {\n  shimChrome: true,\n  shimFirefox: true,\n  shimSafari: true,\n}) {\n  // Utils.\n  const logging = utils.log;\n  const browserDetails = utils.detectBrowser(window);\n\n  const adapter = {\n    browserDetails,\n    commonShim,\n    extractVersion: utils.extractVersion,\n    disableLog: utils.disableLog,\n    disableWarnings: utils.disableWarnings,\n    // Expose sdp as a convenience. For production apps include directly.\n    sdp,\n  };\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection ||\n          !options.shimChrome) {\n        logging('Chrome shim is not included in this adapter release.');\n        return adapter;\n      }\n      if (browserDetails.version === null) {\n        logging('Chrome shim can not determine version, not shimming.');\n        return adapter;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = chromeShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n      chromeShim.shimGetUserMedia(window, browserDetails);\n      chromeShim.shimMediaStream(window, browserDetails);\n      chromeShim.shimPeerConnection(window, browserDetails);\n      chromeShim.shimOnTrack(window, browserDetails);\n      chromeShim.shimAddTrackRemoveTrack(window, browserDetails);\n      chromeShim.shimGetSendersWithDtmf(window, browserDetails);\n      chromeShim.shimGetStats(window, browserDetails);\n      chromeShim.shimSenderReceiverGetStats(window, browserDetails);\n      chromeShim.fixNegotiationNeeded(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimRTCIceCandidateRelayProtocol(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection ||\n          !options.shimFirefox) {\n        logging('Firefox shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = firefoxShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n      firefoxShim.shimGetUserMedia(window, browserDetails);\n      firefoxShim.shimPeerConnection(window, browserDetails);\n      firefoxShim.shimOnTrack(window, browserDetails);\n      firefoxShim.shimRemoveStream(window, browserDetails);\n      firefoxShim.shimSenderGetStats(window, browserDetails);\n      firefoxShim.shimReceiverGetStats(window, browserDetails);\n      firefoxShim.shimRTCDataChannel(window, browserDetails);\n      firefoxShim.shimAddTransceiver(window, browserDetails);\n      firefoxShim.shimGetParameters(window, browserDetails);\n      firefoxShim.shimCreateOffer(window, browserDetails);\n      firefoxShim.shimCreateAnswer(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      break;\n    case 'safari':\n      if (!safariShim || !options.shimSafari) {\n        logging('Safari shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = safariShim;\n\n      // Must be called before shimCallbackAPI.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n      safariShim.shimRTCIceServerUrls(window, browserDetails);\n      safariShim.shimCreateOfferLegacy(window, browserDetails);\n      safariShim.shimCallbacksAPI(window, browserDetails);\n      safariShim.shimLocalStreamsAPI(window, browserDetails);\n      safariShim.shimRemoteStreamsAPI(window, browserDetails);\n      safariShim.shimTrackEventTransceiver(window, browserDetails);\n      safariShim.shimGetUserMedia(window, browserDetails);\n      safariShim.shimAudioContext(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimRTCIceCandidateRelayProtocol(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    default:\n      logging('Unsupported browser!');\n      break;\n  }\n\n  return adapter;\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n\n'use strict';\n\nimport {adapterFactory} from './adapter_factory.js';\n\nconst adapter =\n  adapterFactory({window: typeof window === 'undefined' ? undefined : window});\nexport default adapter;\n","const PACKET_TYPES = Object.create(null); // no Map = no polyfill\nPACKET_TYPES[\"open\"] = \"0\";\nPACKET_TYPES[\"close\"] = \"1\";\nPACKET_TYPES[\"ping\"] = \"2\";\nPACKET_TYPES[\"pong\"] = \"3\";\nPACKET_TYPES[\"message\"] = \"4\";\nPACKET_TYPES[\"upgrade\"] = \"5\";\nPACKET_TYPES[\"noop\"] = \"6\";\nconst PACKET_TYPES_REVERSE = Object.create(null);\nObject.keys(PACKET_TYPES).forEach(key => {\n    PACKET_TYPES_REVERSE[PACKET_TYPES[key]] = key;\n});\nconst ERROR_PACKET = { type: \"error\", data: \"parser error\" };\nexport { PACKET_TYPES, PACKET_TYPES_REVERSE, ERROR_PACKET };\n","import { PACKET_TYPES } from \"./commons.js\";\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        Object.prototype.toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\n// ArrayBuffer.isView method is not defined in IE10\nconst isView = obj => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj && obj.buffer instanceof ArrayBuffer;\n};\nconst encodePacket = ({ type, data }, supportsBinary, callback) => {\n    if (withNativeBlob && data instanceof Blob) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(data, callback);\n        }\n    }\n    else if (withNativeArrayBuffer &&\n        (data instanceof ArrayBuffer || isView(data))) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(new Blob([data]), callback);\n        }\n    }\n    // plain string\n    return callback(PACKET_TYPES[type] + (data || \"\"));\n};\nconst encodeBlobAsBase64 = (data, callback) => {\n    const fileReader = new FileReader();\n    fileReader.onload = function () {\n        const content = fileReader.result.split(\",\")[1];\n        callback(\"b\" + (content || \"\"));\n    };\n    return fileReader.readAsDataURL(data);\n};\nfunction toArray(data) {\n    if (data instanceof Uint8Array) {\n        return data;\n    }\n    else if (data instanceof ArrayBuffer) {\n        return new Uint8Array(data);\n    }\n    else {\n        return new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n    }\n}\nlet TEXT_ENCODER;\nexport function encodePacketToBinary(packet, callback) {\n    if (withNativeBlob && packet.data instanceof Blob) {\n        return packet.data\n            .arrayBuffer()\n            .then(toArray)\n            .then(callback);\n    }\n    else if (withNativeArrayBuffer &&\n        (packet.data instanceof ArrayBuffer || isView(packet.data))) {\n        return callback(toArray(packet.data));\n    }\n    encodePacket(packet, false, encoded => {\n        if (!TEXT_ENCODER) {\n            TEXT_ENCODER = new TextEncoder();\n        }\n        callback(TEXT_ENCODER.encode(encoded));\n    });\n}\nexport { encodePacket };\n","// imported from https://github.com/socketio/base64-arraybuffer\nconst chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n// Use a lookup table to find the index.\nconst lookup = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);\nfor (let i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n}\nexport const encode = (arraybuffer) => {\n    let bytes = new Uint8Array(arraybuffer), i, len = bytes.length, base64 = '';\n    for (i = 0; i < len; i += 3) {\n        base64 += chars[bytes[i] >> 2];\n        base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n        base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n        base64 += chars[bytes[i + 2] & 63];\n    }\n    if (len % 3 === 2) {\n        base64 = base64.substring(0, base64.length - 1) + '=';\n    }\n    else if (len % 3 === 1) {\n        base64 = base64.substring(0, base64.length - 2) + '==';\n    }\n    return base64;\n};\nexport const decode = (base64) => {\n    let bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\n    if (base64[base64.length - 1] === '=') {\n        bufferLength--;\n        if (base64[base64.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n    const arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);\n    for (i = 0; i < len; i += 4) {\n        encoded1 = lookup[base64.charCodeAt(i)];\n        encoded2 = lookup[base64.charCodeAt(i + 1)];\n        encoded3 = lookup[base64.charCodeAt(i + 2)];\n        encoded4 = lookup[base64.charCodeAt(i + 3)];\n        bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n        bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n        bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n    return arraybuffer;\n};\n","import { ERROR_PACKET, PACKET_TYPES_REVERSE } from \"./commons.js\";\nimport { decode } from \"./contrib/base64-arraybuffer.js\";\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nexport const decodePacket = (encodedPacket, binaryType) => {\n    if (typeof encodedPacket !== \"string\") {\n        return {\n            type: \"message\",\n            data: mapBinary(encodedPacket, binaryType)\n        };\n    }\n    const type = encodedPacket.charAt(0);\n    if (type === \"b\") {\n        return {\n            type: \"message\",\n            data: decodeBase64Packet(encodedPacket.substring(1), binaryType)\n        };\n    }\n    const packetType = PACKET_TYPES_REVERSE[type];\n    if (!packetType) {\n        return ERROR_PACKET;\n    }\n    return encodedPacket.length > 1\n        ? {\n            type: PACKET_TYPES_REVERSE[type],\n            data: encodedPacket.substring(1)\n        }\n        : {\n            type: PACKET_TYPES_REVERSE[type]\n        };\n};\nconst decodeBase64Packet = (data, binaryType) => {\n    if (withNativeArrayBuffer) {\n        const decoded = decode(data);\n        return mapBinary(decoded, binaryType);\n    }\n    else {\n        return { base64: true, data }; // fallback for old browsers\n    }\n};\nconst mapBinary = (data, binaryType) => {\n    switch (binaryType) {\n        case \"blob\":\n            if (data instanceof Blob) {\n                // from WebSocket + binaryType \"blob\"\n                return data;\n            }\n            else {\n                // from HTTP long-polling or WebTransport\n                return new Blob([data]);\n            }\n        case \"arraybuffer\":\n        default:\n            if (data instanceof ArrayBuffer) {\n                // from HTTP long-polling (base64) or WebSocket + binaryType \"arraybuffer\"\n                return data;\n            }\n            else {\n                // from WebTransport (Uint8Array)\n                return data.buffer;\n            }\n    }\n};\n","import { encodePacket, encodePacketToBinary } from \"./encodePacket.js\";\nimport { decodePacket } from \"./decodePacket.js\";\nimport { ERROR_PACKET } from \"./commons.js\";\nconst SEPARATOR = String.fromCharCode(30); // see https://en.wikipedia.org/wiki/Delimiter#ASCII_delimited_text\nconst encodePayload = (packets, callback) => {\n    // some packets may be added to the array while encoding, so the initial length must be saved\n    const length = packets.length;\n    const encodedPackets = new Array(length);\n    let count = 0;\n    packets.forEach((packet, i) => {\n        // force base64 encoding for binary packets\n        encodePacket(packet, false, encodedPacket => {\n            encodedPackets[i] = encodedPacket;\n            if (++count === length) {\n                callback(encodedPackets.join(SEPARATOR));\n            }\n        });\n    });\n};\nconst decodePayload = (encodedPayload, binaryType) => {\n    const encodedPackets = encodedPayload.split(SEPARATOR);\n    const packets = [];\n    for (let i = 0; i < encodedPackets.length; i++) {\n        const decodedPacket = decodePacket(encodedPackets[i], binaryType);\n        packets.push(decodedPacket);\n        if (decodedPacket.type === \"error\") {\n            break;\n        }\n    }\n    return packets;\n};\nexport function createPacketEncoderStream() {\n    return new TransformStream({\n        transform(packet, controller) {\n            encodePacketToBinary(packet, encodedPacket => {\n                const payloadLength = encodedPacket.length;\n                let header;\n                // inspired by the WebSocket format: https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_servers#decoding_payload_length\n                if (payloadLength < 126) {\n                    header = new Uint8Array(1);\n                    new DataView(header.buffer).setUint8(0, payloadLength);\n                }\n                else if (payloadLength < 65536) {\n                    header = new Uint8Array(3);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 126);\n                    view.setUint16(1, payloadLength);\n                }\n                else {\n                    header = new Uint8Array(9);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 127);\n                    view.setBigUint64(1, BigInt(payloadLength));\n                }\n                // first bit indicates whether the payload is plain text (0) or binary (1)\n                if (packet.data && typeof packet.data !== \"string\") {\n                    header[0] |= 0x80;\n                }\n                controller.enqueue(header);\n                controller.enqueue(encodedPacket);\n            });\n        }\n    });\n}\nlet TEXT_DECODER;\nfunction totalLength(chunks) {\n    return chunks.reduce((acc, chunk) => acc + chunk.length, 0);\n}\nfunction concatChunks(chunks, size) {\n    if (chunks[0].length === size) {\n        return chunks.shift();\n    }\n    const buffer = new Uint8Array(size);\n    let j = 0;\n    for (let i = 0; i < size; i++) {\n        buffer[i] = chunks[0][j++];\n        if (j === chunks[0].length) {\n            chunks.shift();\n            j = 0;\n        }\n    }\n    if (chunks.length && j < chunks[0].length) {\n        chunks[0] = chunks[0].slice(j);\n    }\n    return buffer;\n}\nexport function createPacketDecoderStream(maxPayload, binaryType) {\n    if (!TEXT_DECODER) {\n        TEXT_DECODER = new TextDecoder();\n    }\n    const chunks = [];\n    let state = 0 /* READ_HEADER */;\n    let expectedLength = -1;\n    let isBinary = false;\n    return new TransformStream({\n        transform(chunk, controller) {\n            chunks.push(chunk);\n            while (true) {\n                if (state === 0 /* READ_HEADER */) {\n                    if (totalLength(chunks) < 1) {\n                        break;\n                    }\n                    const header = concatChunks(chunks, 1);\n                    isBinary = (header[0] & 0x80) === 0x80;\n                    expectedLength = header[0] & 0x7f;\n                    if (expectedLength < 126) {\n                        state = 3 /* READ_PAYLOAD */;\n                    }\n                    else if (expectedLength === 126) {\n                        state = 1 /* READ_EXTENDED_LENGTH_16 */;\n                    }\n                    else {\n                        state = 2 /* READ_EXTENDED_LENGTH_64 */;\n                    }\n                }\n                else if (state === 1 /* READ_EXTENDED_LENGTH_16 */) {\n                    if (totalLength(chunks) < 2) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 2);\n                    expectedLength = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length).getUint16(0);\n                    state = 3 /* READ_PAYLOAD */;\n                }\n                else if (state === 2 /* READ_EXTENDED_LENGTH_64 */) {\n                    if (totalLength(chunks) < 8) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 8);\n                    const view = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length);\n                    const n = view.getUint32(0);\n                    if (n > Math.pow(2, 53 - 32) - 1) {\n                        // the maximum safe integer in JavaScript is 2^53 - 1\n                        controller.enqueue(ERROR_PACKET);\n                        break;\n                    }\n                    expectedLength = n * Math.pow(2, 32) + view.getUint32(4);\n                    state = 3 /* READ_PAYLOAD */;\n                }\n                else {\n                    if (totalLength(chunks) < expectedLength) {\n                        break;\n                    }\n                    const data = concatChunks(chunks, expectedLength);\n                    controller.enqueue(decodePacket(isBinary ? data : TEXT_DECODER.decode(data), binaryType));\n                    state = 0 /* READ_HEADER */;\n                }\n                if (expectedLength === 0 || expectedLength > maxPayload) {\n                    controller.enqueue(ERROR_PACKET);\n                    break;\n                }\n            }\n        }\n    });\n}\nexport const protocol = 4;\nexport { encodePacket, encodePayload, decodePacket, decodePayload };\n","/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nexport function Emitter(obj) {\n  if (obj) return mixin(obj);\n}\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  function on() {\n    this.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks['$' + event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks['$' + event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n\n  // Remove event specific arrays for event types that no\n  // one is subscribed for to avoid memory leak.\n  if (callbacks.length === 0) {\n    delete this._callbacks['$' + event];\n  }\n\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n\n  var args = new Array(arguments.length - 1)\n    , callbacks = this._callbacks['$' + event];\n\n  for (var i = 1; i < arguments.length; i++) {\n    args[i - 1] = arguments[i];\n  }\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n// alias used for reserved events (protected method)\nEmitter.prototype.emitReserved = Emitter.prototype.emit;\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks['$' + event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n","export const globalThisShim = (() => {\n    if (typeof self !== \"undefined\") {\n        return self;\n    }\n    else if (typeof window !== \"undefined\") {\n        return window;\n    }\n    else {\n        return Function(\"return this\")();\n    }\n})();\n","import { globalThisShim as globalThis } from \"./globalThis.js\";\nexport function pick(obj, ...attr) {\n    return attr.reduce((acc, k) => {\n        if (obj.hasOwnProperty(k)) {\n            acc[k] = obj[k];\n        }\n        return acc;\n    }, {});\n}\n// Keep a reference to the real timeout functions so they can be used when overridden\nconst NATIVE_SET_TIMEOUT = globalThis.setTimeout;\nconst NATIVE_CLEAR_TIMEOUT = globalThis.clearTimeout;\nexport function installTimerFunctions(obj, opts) {\n    if (opts.useNativeTimers) {\n        obj.setTimeoutFn = NATIVE_SET_TIMEOUT.bind(globalThis);\n        obj.clearTimeoutFn = NATIVE_CLEAR_TIMEOUT.bind(globalThis);\n    }\n    else {\n        obj.setTimeoutFn = globalThis.setTimeout.bind(globalThis);\n        obj.clearTimeoutFn = globalThis.clearTimeout.bind(globalThis);\n    }\n}\n// base64 encoded buffers are about 33% bigger (https://en.wikipedia.org/wiki/Base64)\nconst BASE64_OVERHEAD = 1.33;\n// we could also have used `new Blob([obj]).size`, but it isn't supported in IE9\nexport function byteLength(obj) {\n    if (typeof obj === \"string\") {\n        return utf8Length(obj);\n    }\n    // arraybuffer or blob\n    return Math.ceil((obj.byteLength || obj.size) * BASE64_OVERHEAD);\n}\nfunction utf8Length(str) {\n    let c = 0, length = 0;\n    for (let i = 0, l = str.length; i < l; i++) {\n        c = str.charCodeAt(i);\n        if (c < 0x80) {\n            length += 1;\n        }\n        else if (c < 0x800) {\n            length += 2;\n        }\n        else if (c < 0xd800 || c >= 0xe000) {\n            length += 3;\n        }\n        else {\n            i++;\n            length += 4;\n        }\n    }\n    return length;\n}\n","import { decodePacket } from \"engine.io-parser\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions } from \"./util.js\";\nimport { encode } from \"./contrib/parseqs.js\";\nexport class TransportError extends Error {\n    constructor(reason, description, context) {\n        super(reason);\n        this.description = description;\n        this.context = context;\n        this.type = \"TransportError\";\n    }\n}\nexport class Transport extends Emitter {\n    /**\n     * Transport abstract constructor.\n     *\n     * @param {Object} opts - options\n     * @protected\n     */\n    constructor(opts) {\n        super();\n        this.writable = false;\n        installTimerFunctions(this, opts);\n        this.opts = opts;\n        this.query = opts.query;\n        this.socket = opts.socket;\n    }\n    /**\n     * Emits an error.\n     *\n     * @param {String} reason\n     * @param description\n     * @param context - the error context\n     * @return {Transport} for chaining\n     * @protected\n     */\n    onError(reason, description, context) {\n        super.emitReserved(\"error\", new TransportError(reason, description, context));\n        return this;\n    }\n    /**\n     * Opens the transport.\n     */\n    open() {\n        this.readyState = \"opening\";\n        this.doOpen();\n        return this;\n    }\n    /**\n     * Closes the transport.\n     */\n    close() {\n        if (this.readyState === \"opening\" || this.readyState === \"open\") {\n            this.doClose();\n            this.onClose();\n        }\n        return this;\n    }\n    /**\n     * Sends multiple packets.\n     *\n     * @param {Array} packets\n     */\n    send(packets) {\n        if (this.readyState === \"open\") {\n            this.write(packets);\n        }\n        else {\n            // this might happen if the transport was silently closed in the beforeunload event handler\n        }\n    }\n    /**\n     * Called upon open\n     *\n     * @protected\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        this.writable = true;\n        super.emitReserved(\"open\");\n    }\n    /**\n     * Called with data.\n     *\n     * @param {String} data\n     * @protected\n     */\n    onData(data) {\n        const packet = decodePacket(data, this.socket.binaryType);\n        this.onPacket(packet);\n    }\n    /**\n     * Called with a decoded packet.\n     *\n     * @protected\n     */\n    onPacket(packet) {\n        super.emitReserved(\"packet\", packet);\n    }\n    /**\n     * Called upon close.\n     *\n     * @protected\n     */\n    onClose(details) {\n        this.readyState = \"closed\";\n        super.emitReserved(\"close\", details);\n    }\n    /**\n     * Pauses the transport, in order not to lose packets during an upgrade.\n     *\n     * @param onPause\n     */\n    pause(onPause) { }\n    createUri(schema, query = {}) {\n        return (schema +\n            \"://\" +\n            this._hostname() +\n            this._port() +\n            this.opts.path +\n            this._query(query));\n    }\n    _hostname() {\n        const hostname = this.opts.hostname;\n        return hostname.indexOf(\":\") === -1 ? hostname : \"[\" + hostname + \"]\";\n    }\n    _port() {\n        if (this.opts.port &&\n            ((this.opts.secure && Number(this.opts.port !== 443)) ||\n                (!this.opts.secure && Number(this.opts.port) !== 80))) {\n            return \":\" + this.opts.port;\n        }\n        else {\n            return \"\";\n        }\n    }\n    _query(query) {\n        const encodedQuery = encode(query);\n        return encodedQuery.length ? \"?\" + encodedQuery : \"\";\n    }\n}\n","// imported from https://github.com/galkn/querystring\n/**\n * Compiles a querystring\n * Returns string representation of the object\n *\n * @param {Object}\n * @api private\n */\nexport function encode(obj) {\n    let str = '';\n    for (let i in obj) {\n        if (obj.hasOwnProperty(i)) {\n            if (str.length)\n                str += '&';\n            str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\n        }\n    }\n    return str;\n}\n/**\n * Parses a simple querystring into an object\n *\n * @param {String} qs\n * @api private\n */\nexport function decode(qs) {\n    let qry = {};\n    let pairs = qs.split('&');\n    for (let i = 0, l = pairs.length; i < l; i++) {\n        let pair = pairs[i].split('=');\n        qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n    }\n    return qry;\n}\n","// imported from https://github.com/unshiftio/yeast\n'use strict';\nconst alphabet = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_'.split(''), length = 64, map = {};\nlet seed = 0, i = 0, prev;\n/**\n * Return a string representing the specified number.\n *\n * @param {Number} num The number to convert.\n * @returns {String} The string representation of the number.\n * @api public\n */\nexport function encode(num) {\n    let encoded = '';\n    do {\n        encoded = alphabet[num % length] + encoded;\n        num = Math.floor(num / length);\n    } while (num > 0);\n    return encoded;\n}\n/**\n * Return the integer value specified by the given string.\n *\n * @param {String} str The string to convert.\n * @returns {Number} The integer value represented by the string.\n * @api public\n */\nexport function decode(str) {\n    let decoded = 0;\n    for (i = 0; i < str.length; i++) {\n        decoded = decoded * length + map[str.charAt(i)];\n    }\n    return decoded;\n}\n/**\n * Yeast: A tiny growing id generator.\n *\n * @returns {String} A unique id.\n * @api public\n */\nexport function yeast() {\n    const now = encode(+new Date());\n    if (now !== prev)\n        return seed = 0, prev = now;\n    return now + '.' + encode(seed++);\n}\n//\n// Map each character to its index.\n//\nfor (; i < length; i++)\n    map[alphabet[i]] = i;\n","// imported from https://github.com/component/has-cors\nlet value = false;\ntry {\n    value = typeof XMLHttpRequest !== 'undefined' &&\n        'withCredentials' in new XMLHttpRequest();\n}\ncatch (err) {\n    // if XMLHttp support is disabled in IE then it will throw\n    // when trying to create\n}\nexport const hasCORS = value;\n","// browser shim for xmlhttprequest module\nimport { hasCORS } from \"../contrib/has-cors.js\";\nimport { globalThisShim as globalThis } from \"../globalThis.js\";\nexport function XHR(opts) {\n    const xdomain = opts.xdomain;\n    // XMLHttpRequest can be disabled on IE\n    try {\n        if (\"undefined\" !== typeof XMLHttpRequest && (!xdomain || hasCORS)) {\n            return new XMLHttpRequest();\n        }\n    }\n    catch (e) { }\n    if (!xdomain) {\n        try {\n            return new globalThis[[\"Active\"].concat(\"Object\").join(\"X\")](\"Microsoft.XMLHTTP\");\n        }\n        catch (e) { }\n    }\n}\nexport function createCookieJar() { }\n","import { Transport } from \"../transport.js\";\nimport { yeast } from \"../contrib/yeast.js\";\nimport { encodePayload, decodePayload } from \"engine.io-parser\";\nimport { createCookieJar, XHR as XMLHttpRequest, } from \"./xmlhttprequest.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions, pick } from \"../util.js\";\nimport { globalThisShim as globalThis } from \"../globalThis.js\";\nfunction empty() { }\nconst hasXHR2 = (function () {\n    const xhr = new XMLHttpRequest({\n        xdomain: false,\n    });\n    return null != xhr.responseType;\n})();\nexport class Polling extends Transport {\n    /**\n     * XHR Polling constructor.\n     *\n     * @param {Object} opts\n     * @package\n     */\n    constructor(opts) {\n        super(opts);\n        this.polling = false;\n        if (typeof location !== \"undefined\") {\n            const isSSL = \"https:\" === location.protocol;\n            let port = location.port;\n            // some user agents have empty `location.port`\n            if (!port) {\n                port = isSSL ? \"443\" : \"80\";\n            }\n            this.xd =\n                (typeof location !== \"undefined\" &&\n                    opts.hostname !== location.hostname) ||\n                    port !== opts.port;\n        }\n        /**\n         * XHR supports binary\n         */\n        const forceBase64 = opts && opts.forceBase64;\n        this.supportsBinary = hasXHR2 && !forceBase64;\n        if (this.opts.withCredentials) {\n            this.cookieJar = createCookieJar();\n        }\n    }\n    get name() {\n        return \"polling\";\n    }\n    /**\n     * Opens the socket (triggers polling). We write a PING message to determine\n     * when the transport is open.\n     *\n     * @protected\n     */\n    doOpen() {\n        this.poll();\n    }\n    /**\n     * Pauses polling.\n     *\n     * @param {Function} onPause - callback upon buffers are flushed and transport is paused\n     * @package\n     */\n    pause(onPause) {\n        this.readyState = \"pausing\";\n        const pause = () => {\n            this.readyState = \"paused\";\n            onPause();\n        };\n        if (this.polling || !this.writable) {\n            let total = 0;\n            if (this.polling) {\n                total++;\n                this.once(\"pollComplete\", function () {\n                    --total || pause();\n                });\n            }\n            if (!this.writable) {\n                total++;\n                this.once(\"drain\", function () {\n                    --total || pause();\n                });\n            }\n        }\n        else {\n            pause();\n        }\n    }\n    /**\n     * Starts polling cycle.\n     *\n     * @private\n     */\n    poll() {\n        this.polling = true;\n        this.doPoll();\n        this.emitReserved(\"poll\");\n    }\n    /**\n     * Overloads onData to detect payloads.\n     *\n     * @protected\n     */\n    onData(data) {\n        const callback = (packet) => {\n            // if its the first message we consider the transport open\n            if (\"opening\" === this.readyState && packet.type === \"open\") {\n                this.onOpen();\n            }\n            // if its a close packet, we close the ongoing requests\n            if (\"close\" === packet.type) {\n                this.onClose({ description: \"transport closed by the server\" });\n                return false;\n            }\n            // otherwise bypass onData and handle the message\n            this.onPacket(packet);\n        };\n        // decode payload\n        decodePayload(data, this.socket.binaryType).forEach(callback);\n        // if an event did not trigger closing\n        if (\"closed\" !== this.readyState) {\n            // if we got data we're not polling\n            this.polling = false;\n            this.emitReserved(\"pollComplete\");\n            if (\"open\" === this.readyState) {\n                this.poll();\n            }\n            else {\n            }\n        }\n    }\n    /**\n     * For polling, send a close packet.\n     *\n     * @protected\n     */\n    doClose() {\n        const close = () => {\n            this.write([{ type: \"close\" }]);\n        };\n        if (\"open\" === this.readyState) {\n            close();\n        }\n        else {\n            // in case we're trying to close while\n            // handshaking is in progress (GH-164)\n            this.once(\"open\", close);\n        }\n    }\n    /**\n     * Writes a packets payload.\n     *\n     * @param {Array} packets - data packets\n     * @protected\n     */\n    write(packets) {\n        this.writable = false;\n        encodePayload(packets, (data) => {\n            this.doWrite(data, () => {\n                this.writable = true;\n                this.emitReserved(\"drain\");\n            });\n        });\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? \"https\" : \"http\";\n        const query = this.query || {};\n        // cache busting is forced\n        if (false !== this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = yeast();\n        }\n        if (!this.supportsBinary && !query.sid) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n    /**\n     * Creates a request.\n     *\n     * @param {String} method\n     * @private\n     */\n    request(opts = {}) {\n        Object.assign(opts, { xd: this.xd, cookieJar: this.cookieJar }, this.opts);\n        return new Request(this.uri(), opts);\n    }\n    /**\n     * Sends data.\n     *\n     * @param {String} data to send.\n     * @param {Function} called upon flush.\n     * @private\n     */\n    doWrite(data, fn) {\n        const req = this.request({\n            method: \"POST\",\n            data: data,\n        });\n        req.on(\"success\", fn);\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr post error\", xhrStatus, context);\n        });\n    }\n    /**\n     * Starts a poll cycle.\n     *\n     * @private\n     */\n    doPoll() {\n        const req = this.request();\n        req.on(\"data\", this.onData.bind(this));\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr poll error\", xhrStatus, context);\n        });\n        this.pollXhr = req;\n    }\n}\nexport class Request extends Emitter {\n    /**\n     * Request constructor\n     *\n     * @param {Object} options\n     * @package\n     */\n    constructor(uri, opts) {\n        super();\n        installTimerFunctions(this, opts);\n        this.opts = opts;\n        this.method = opts.method || \"GET\";\n        this.uri = uri;\n        this.data = undefined !== opts.data ? opts.data : null;\n        this.create();\n    }\n    /**\n     * Creates the XHR object and sends the request.\n     *\n     * @private\n     */\n    create() {\n        var _a;\n        const opts = pick(this.opts, \"agent\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"autoUnref\");\n        opts.xdomain = !!this.opts.xd;\n        const xhr = (this.xhr = new XMLHttpRequest(opts));\n        try {\n            xhr.open(this.method, this.uri, true);\n            try {\n                if (this.opts.extraHeaders) {\n                    xhr.setDisableHeaderCheck && xhr.setDisableHeaderCheck(true);\n                    for (let i in this.opts.extraHeaders) {\n                        if (this.opts.extraHeaders.hasOwnProperty(i)) {\n                            xhr.setRequestHeader(i, this.opts.extraHeaders[i]);\n                        }\n                    }\n                }\n            }\n            catch (e) { }\n            if (\"POST\" === this.method) {\n                try {\n                    xhr.setRequestHeader(\"Content-type\", \"text/plain;charset=UTF-8\");\n                }\n                catch (e) { }\n            }\n            try {\n                xhr.setRequestHeader(\"Accept\", \"*/*\");\n            }\n            catch (e) { }\n            (_a = this.opts.cookieJar) === null || _a === void 0 ? void 0 : _a.addCookies(xhr);\n            // ie6 check\n            if (\"withCredentials\" in xhr) {\n                xhr.withCredentials = this.opts.withCredentials;\n            }\n            if (this.opts.requestTimeout) {\n                xhr.timeout = this.opts.requestTimeout;\n            }\n            xhr.onreadystatechange = () => {\n                var _a;\n                if (xhr.readyState === 3) {\n                    (_a = this.opts.cookieJar) === null || _a === void 0 ? void 0 : _a.parseCookies(xhr);\n                }\n                if (4 !== xhr.readyState)\n                    return;\n                if (200 === xhr.status || 1223 === xhr.status) {\n                    this.onLoad();\n                }\n                else {\n                    // make sure the `error` event handler that's user-set\n                    // does not throw in the same tick and gets caught here\n                    this.setTimeoutFn(() => {\n                        this.onError(typeof xhr.status === \"number\" ? xhr.status : 0);\n                    }, 0);\n                }\n            };\n            xhr.send(this.data);\n        }\n        catch (e) {\n            // Need to defer since .create() is called directly from the constructor\n            // and thus the 'error' event can only be only bound *after* this exception\n            // occurs.  Therefore, also, we cannot throw here at all.\n            this.setTimeoutFn(() => {\n                this.onError(e);\n            }, 0);\n            return;\n        }\n        if (typeof document !== \"undefined\") {\n            this.index = Request.requestsCount++;\n            Request.requests[this.index] = this;\n        }\n    }\n    /**\n     * Called upon error.\n     *\n     * @private\n     */\n    onError(err) {\n        this.emitReserved(\"error\", err, this.xhr);\n        this.cleanup(true);\n    }\n    /**\n     * Cleans up house.\n     *\n     * @private\n     */\n    cleanup(fromError) {\n        if (\"undefined\" === typeof this.xhr || null === this.xhr) {\n            return;\n        }\n        this.xhr.onreadystatechange = empty;\n        if (fromError) {\n            try {\n                this.xhr.abort();\n            }\n            catch (e) { }\n        }\n        if (typeof document !== \"undefined\") {\n            delete Request.requests[this.index];\n        }\n        this.xhr = null;\n    }\n    /**\n     * Called upon load.\n     *\n     * @private\n     */\n    onLoad() {\n        const data = this.xhr.responseText;\n        if (data !== null) {\n            this.emitReserved(\"data\", data);\n            this.emitReserved(\"success\");\n            this.cleanup();\n        }\n    }\n    /**\n     * Aborts the request.\n     *\n     * @package\n     */\n    abort() {\n        this.cleanup();\n    }\n}\nRequest.requestsCount = 0;\nRequest.requests = {};\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\nif (typeof document !== \"undefined\") {\n    // @ts-ignore\n    if (typeof attachEvent === \"function\") {\n        // @ts-ignore\n        attachEvent(\"onunload\", unloadHandler);\n    }\n    else if (typeof addEventListener === \"function\") {\n        const terminationEvent = \"onpagehide\" in globalThis ? \"pagehide\" : \"unload\";\n        addEventListener(terminationEvent, unloadHandler, false);\n    }\n}\nfunction unloadHandler() {\n    for (let i in Request.requests) {\n        if (Request.requests.hasOwnProperty(i)) {\n            Request.requests[i].abort();\n        }\n    }\n}\n","import { globalThisShim as globalThis } from \"../globalThis.js\";\nexport const nextTick = (() => {\n    const isPromiseAvailable = typeof Promise === \"function\" && typeof Promise.resolve === \"function\";\n    if (isPromiseAvailable) {\n        return (cb) => Promise.resolve().then(cb);\n    }\n    else {\n        return (cb, setTimeoutFn) => setTimeoutFn(cb, 0);\n    }\n})();\nexport const WebSocket = globalThis.WebSocket || globalThis.MozWebSocket;\nexport const usingBrowserWebSocket = true;\nexport const defaultBinaryType = \"arraybuffer\";\n","import { Transport } from \"../transport.js\";\nimport { yeast } from \"../contrib/yeast.js\";\nimport { pick } from \"../util.js\";\nimport { nextTick, usingBrowserWebSocket, WebSocket, } from \"./websocket-constructor.js\";\nimport { encodePacket } from \"engine.io-parser\";\n// detect ReactNative environment\nconst isReactNative = typeof navigator !== \"undefined\" &&\n    typeof navigator.product === \"string\" &&\n    navigator.product.toLowerCase() === \"reactnative\";\nexport class WS extends Transport {\n    /**\n     * WebSocket transport constructor.\n     *\n     * @param {Object} opts - connection options\n     * @protected\n     */\n    constructor(opts) {\n        super(opts);\n        this.supportsBinary = !opts.forceBase64;\n    }\n    get name() {\n        return \"websocket\";\n    }\n    doOpen() {\n        if (!this.check()) {\n            // let probe timeout\n            return;\n        }\n        const uri = this.uri();\n        const protocols = this.opts.protocols;\n        // React Native only supports the 'headers' option, and will print a warning if anything else is passed\n        const opts = isReactNative\n            ? {}\n            : pick(this.opts, \"agent\", \"perMessageDeflate\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"localAddress\", \"protocolVersion\", \"origin\", \"maxPayload\", \"family\", \"checkServerIdentity\");\n        if (this.opts.extraHeaders) {\n            opts.headers = this.opts.extraHeaders;\n        }\n        try {\n            this.ws =\n                usingBrowserWebSocket && !isReactNative\n                    ? protocols\n                        ? new WebSocket(uri, protocols)\n                        : new WebSocket(uri)\n                    : new WebSocket(uri, protocols, opts);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this.ws.binaryType = this.socket.binaryType;\n        this.addEventListeners();\n    }\n    /**\n     * Adds event listeners to the socket\n     *\n     * @private\n     */\n    addEventListeners() {\n        this.ws.onopen = () => {\n            if (this.opts.autoUnref) {\n                this.ws._socket.unref();\n            }\n            this.onOpen();\n        };\n        this.ws.onclose = (closeEvent) => this.onClose({\n            description: \"websocket connection closed\",\n            context: closeEvent,\n        });\n        this.ws.onmessage = (ev) => this.onData(ev.data);\n        this.ws.onerror = (e) => this.onError(\"websocket error\", e);\n    }\n    write(packets) {\n        this.writable = false;\n        // encodePacket efficient as it uses WS framing\n        // no need for encodePayload\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            encodePacket(packet, this.supportsBinary, (data) => {\n                // always create a new object (GH-437)\n                const opts = {};\n                if (!usingBrowserWebSocket) {\n                    if (packet.options) {\n                        opts.compress = packet.options.compress;\n                    }\n                    if (this.opts.perMessageDeflate) {\n                        const len = \n                        // @ts-ignore\n                        \"string\" === typeof data ? Buffer.byteLength(data) : data.length;\n                        if (len < this.opts.perMessageDeflate.threshold) {\n                            opts.compress = false;\n                        }\n                    }\n                }\n                // Sometimes the websocket has already been closed but the browser didn't\n                // have a chance of informing us about it yet, in that case send will\n                // throw an error\n                try {\n                    if (usingBrowserWebSocket) {\n                        // TypeError is thrown when passing the second argument on Safari\n                        this.ws.send(data);\n                    }\n                    else {\n                        this.ws.send(data, opts);\n                    }\n                }\n                catch (e) {\n                }\n                if (lastPacket) {\n                    // fake drain\n                    // defer to next tick to allow Socket to clear writeBuffer\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        if (typeof this.ws !== \"undefined\") {\n            this.ws.close();\n            this.ws = null;\n        }\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? \"wss\" : \"ws\";\n        const query = this.query || {};\n        // append timestamp to URI\n        if (this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = yeast();\n        }\n        // communicate binary support capabilities\n        if (!this.supportsBinary) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n    /**\n     * Feature detection for WebSocket.\n     *\n     * @return {Boolean} whether this transport is available.\n     * @private\n     */\n    check() {\n        return !!WebSocket;\n    }\n}\n","import { Polling } from \"./polling.js\";\nimport { WS } from \"./websocket.js\";\nimport { WT } from \"./webtransport.js\";\nexport const transports = {\n    websocket: WS,\n    webtransport: WT,\n    polling: Polling,\n};\n","import { Transport } from \"../transport.js\";\nimport { nextTick } from \"./websocket-constructor.js\";\nimport { createPacketDecoderStream, createPacketEncoderStream, } from \"engine.io-parser\";\nexport class WT extends Transport {\n    get name() {\n        return \"webtransport\";\n    }\n    doOpen() {\n        // @ts-ignore\n        if (typeof WebTransport !== \"function\") {\n            return;\n        }\n        // @ts-ignore\n        this.transport = new WebTransport(this.createUri(\"https\"), this.opts.transportOptions[this.name]);\n        this.transport.closed\n            .then(() => {\n            this.onClose();\n        })\n            .catch((err) => {\n            this.onError(\"webtransport error\", err);\n        });\n        // note: we could have used async/await, but that would require some additional polyfills\n        this.transport.ready.then(() => {\n            this.transport.createBidirectionalStream().then((stream) => {\n                const decoderStream = createPacketDecoderStream(Number.MAX_SAFE_INTEGER, this.socket.binaryType);\n                const reader = stream.readable.pipeThrough(decoderStream).getReader();\n                const encoderStream = createPacketEncoderStream();\n                encoderStream.readable.pipeTo(stream.writable);\n                this.writer = encoderStream.writable.getWriter();\n                const read = () => {\n                    reader\n                        .read()\n                        .then(({ done, value }) => {\n                        if (done) {\n                            return;\n                        }\n                        this.onPacket(value);\n                        read();\n                    })\n                        .catch((err) => {\n                    });\n                };\n                read();\n                const packet = { type: \"open\" };\n                if (this.query.sid) {\n                    packet.data = `{\"sid\":\"${this.query.sid}\"}`;\n                }\n                this.writer.write(packet).then(() => this.onOpen());\n            });\n        });\n    }\n    write(packets) {\n        this.writable = false;\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            this.writer.write(packet).then(() => {\n                if (lastPacket) {\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        var _a;\n        (_a = this.transport) === null || _a === void 0 ? void 0 : _a.close();\n    }\n}\n","// imported from https://github.com/galkn/parseuri\n/**\n * Parses a URI\n *\n * Note: we could also have used the built-in URL object, but it isn't supported on all platforms.\n *\n * See:\n * - https://developer.mozilla.org/en-US/docs/Web/API/URL\n * - https://caniuse.com/url\n * - https://www.rfc-editor.org/rfc/rfc3986#appendix-B\n *\n * History of the parse() method:\n * - first commit: https://github.com/socketio/socket.io-client/commit/4ee1d5d94b3906a9c052b459f1a818b15f38f91c\n * - export into its own module: https://github.com/socketio/engine.io-client/commit/de2c561e4564efeb78f1bdb1ba39ef81b2822cb3\n * - reimport: https://github.com/socketio/engine.io-client/commit/df32277c3f6d622eec5ed09f493cae3f3391d242\n *\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\n * @api private\n */\nconst re = /^(?:(?![^:@\\/?#]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@\\/?#]*)(?::([^:@\\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\nconst parts = [\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\n];\nexport function parse(str) {\n    if (str.length > 2000) {\n        throw \"URI too long\";\n    }\n    const src = str, b = str.indexOf('['), e = str.indexOf(']');\n    if (b != -1 && e != -1) {\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\n    }\n    let m = re.exec(str || ''), uri = {}, i = 14;\n    while (i--) {\n        uri[parts[i]] = m[i] || '';\n    }\n    if (b != -1 && e != -1) {\n        uri.source = src;\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\n        uri.ipv6uri = true;\n    }\n    uri.pathNames = pathNames(uri, uri['path']);\n    uri.queryKey = queryKey(uri, uri['query']);\n    return uri;\n}\nfunction pathNames(obj, path) {\n    const regx = /\\/{2,9}/g, names = path.replace(regx, \"/\").split(\"/\");\n    if (path.slice(0, 1) == '/' || path.length === 0) {\n        names.splice(0, 1);\n    }\n    if (path.slice(-1) == '/') {\n        names.splice(names.length - 1, 1);\n    }\n    return names;\n}\nfunction queryKey(uri, query) {\n    const data = {};\n    query.replace(/(?:^|&)([^&=]*)=?([^&]*)/g, function ($0, $1, $2) {\n        if ($1) {\n            data[$1] = $2;\n        }\n    });\n    return data;\n}\n","import { transports } from \"./transports/index.js\";\nimport { installTimerFunctions, byteLength } from \"./util.js\";\nimport { decode } from \"./contrib/parseqs.js\";\nimport { parse } from \"./contrib/parseuri.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { protocol } from \"engine.io-parser\";\nimport { defaultBinaryType } from \"./transports/websocket-constructor.js\";\nexport class Socket extends Emitter {\n    /**\n     * Socket constructor.\n     *\n     * @param {String|Object} uri - uri or options\n     * @param {Object} opts - options\n     */\n    constructor(uri, opts = {}) {\n        super();\n        this.binaryType = defaultBinaryType;\n        this.writeBuffer = [];\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = null;\n        }\n        if (uri) {\n            uri = parse(uri);\n            opts.hostname = uri.host;\n            opts.secure = uri.protocol === \"https\" || uri.protocol === \"wss\";\n            opts.port = uri.port;\n            if (uri.query)\n                opts.query = uri.query;\n        }\n        else if (opts.host) {\n            opts.hostname = parse(opts.host).host;\n        }\n        installTimerFunctions(this, opts);\n        this.secure =\n            null != opts.secure\n                ? opts.secure\n                : typeof location !== \"undefined\" && \"https:\" === location.protocol;\n        if (opts.hostname && !opts.port) {\n            // if no port is specified manually, use the protocol default\n            opts.port = this.secure ? \"443\" : \"80\";\n        }\n        this.hostname =\n            opts.hostname ||\n                (typeof location !== \"undefined\" ? location.hostname : \"localhost\");\n        this.port =\n            opts.port ||\n                (typeof location !== \"undefined\" && location.port\n                    ? location.port\n                    : this.secure\n                        ? \"443\"\n                        : \"80\");\n        this.transports = opts.transports || [\n            \"polling\",\n            \"websocket\",\n            \"webtransport\",\n        ];\n        this.writeBuffer = [];\n        this.prevBufferLen = 0;\n        this.opts = Object.assign({\n            path: \"/engine.io\",\n            agent: false,\n            withCredentials: false,\n            upgrade: true,\n            timestampParam: \"t\",\n            rememberUpgrade: false,\n            addTrailingSlash: true,\n            rejectUnauthorized: true,\n            perMessageDeflate: {\n                threshold: 1024,\n            },\n            transportOptions: {},\n            closeOnBeforeunload: false,\n        }, opts);\n        this.opts.path =\n            this.opts.path.replace(/\\/$/, \"\") +\n                (this.opts.addTrailingSlash ? \"/\" : \"\");\n        if (typeof this.opts.query === \"string\") {\n            this.opts.query = decode(this.opts.query);\n        }\n        // set on handshake\n        this.id = null;\n        this.upgrades = null;\n        this.pingInterval = null;\n        this.pingTimeout = null;\n        // set on heartbeat\n        this.pingTimeoutTimer = null;\n        if (typeof addEventListener === \"function\") {\n            if (this.opts.closeOnBeforeunload) {\n                // Firefox closes the connection when the \"beforeunload\" event is emitted but not Chrome. This event listener\n                // ensures every browser behaves the same (no \"disconnect\" event at the Socket.IO level when the page is\n                // closed/reloaded)\n                this.beforeunloadEventListener = () => {\n                    if (this.transport) {\n                        // silently close the transport\n                        this.transport.removeAllListeners();\n                        this.transport.close();\n                    }\n                };\n                addEventListener(\"beforeunload\", this.beforeunloadEventListener, false);\n            }\n            if (this.hostname !== \"localhost\") {\n                this.offlineEventListener = () => {\n                    this.onClose(\"transport close\", {\n                        description: \"network connection lost\",\n                    });\n                };\n                addEventListener(\"offline\", this.offlineEventListener, false);\n            }\n        }\n        this.open();\n    }\n    /**\n     * Creates transport of the given type.\n     *\n     * @param {String} name - transport name\n     * @return {Transport}\n     * @private\n     */\n    createTransport(name) {\n        const query = Object.assign({}, this.opts.query);\n        // append engine.io protocol identifier\n        query.EIO = protocol;\n        // transport name\n        query.transport = name;\n        // session id if we already have one\n        if (this.id)\n            query.sid = this.id;\n        const opts = Object.assign({}, this.opts, {\n            query,\n            socket: this,\n            hostname: this.hostname,\n            secure: this.secure,\n            port: this.port,\n        }, this.opts.transportOptions[name]);\n        return new transports[name](opts);\n    }\n    /**\n     * Initializes transport to use and starts probe.\n     *\n     * @private\n     */\n    open() {\n        let transport;\n        if (this.opts.rememberUpgrade &&\n            Socket.priorWebsocketSuccess &&\n            this.transports.indexOf(\"websocket\") !== -1) {\n            transport = \"websocket\";\n        }\n        else if (0 === this.transports.length) {\n            // Emit error on next tick so it can be listened to\n            this.setTimeoutFn(() => {\n                this.emitReserved(\"error\", \"No transports available\");\n            }, 0);\n            return;\n        }\n        else {\n            transport = this.transports[0];\n        }\n        this.readyState = \"opening\";\n        // Retry with the next transport if the transport is disabled (jsonp: false)\n        try {\n            transport = this.createTransport(transport);\n        }\n        catch (e) {\n            this.transports.shift();\n            this.open();\n            return;\n        }\n        transport.open();\n        this.setTransport(transport);\n    }\n    /**\n     * Sets the current transport. Disables the existing one (if any).\n     *\n     * @private\n     */\n    setTransport(transport) {\n        if (this.transport) {\n            this.transport.removeAllListeners();\n        }\n        // set up transport\n        this.transport = transport;\n        // set up transport listeners\n        transport\n            .on(\"drain\", this.onDrain.bind(this))\n            .on(\"packet\", this.onPacket.bind(this))\n            .on(\"error\", this.onError.bind(this))\n            .on(\"close\", (reason) => this.onClose(\"transport close\", reason));\n    }\n    /**\n     * Probes a transport.\n     *\n     * @param {String} name - transport name\n     * @private\n     */\n    probe(name) {\n        let transport = this.createTransport(name);\n        let failed = false;\n        Socket.priorWebsocketSuccess = false;\n        const onTransportOpen = () => {\n            if (failed)\n                return;\n            transport.send([{ type: \"ping\", data: \"probe\" }]);\n            transport.once(\"packet\", (msg) => {\n                if (failed)\n                    return;\n                if (\"pong\" === msg.type && \"probe\" === msg.data) {\n                    this.upgrading = true;\n                    this.emitReserved(\"upgrading\", transport);\n                    if (!transport)\n                        return;\n                    Socket.priorWebsocketSuccess = \"websocket\" === transport.name;\n                    this.transport.pause(() => {\n                        if (failed)\n                            return;\n                        if (\"closed\" === this.readyState)\n                            return;\n                        cleanup();\n                        this.setTransport(transport);\n                        transport.send([{ type: \"upgrade\" }]);\n                        this.emitReserved(\"upgrade\", transport);\n                        transport = null;\n                        this.upgrading = false;\n                        this.flush();\n                    });\n                }\n                else {\n                    const err = new Error(\"probe error\");\n                    // @ts-ignore\n                    err.transport = transport.name;\n                    this.emitReserved(\"upgradeError\", err);\n                }\n            });\n        };\n        function freezeTransport() {\n            if (failed)\n                return;\n            // Any callback called by transport should be ignored since now\n            failed = true;\n            cleanup();\n            transport.close();\n            transport = null;\n        }\n        // Handle any error that happens while probing\n        const onerror = (err) => {\n            const error = new Error(\"probe error: \" + err);\n            // @ts-ignore\n            error.transport = transport.name;\n            freezeTransport();\n            this.emitReserved(\"upgradeError\", error);\n        };\n        function onTransportClose() {\n            onerror(\"transport closed\");\n        }\n        // When the socket is closed while we're probing\n        function onclose() {\n            onerror(\"socket closed\");\n        }\n        // When the socket is upgraded while we're probing\n        function onupgrade(to) {\n            if (transport && to.name !== transport.name) {\n                freezeTransport();\n            }\n        }\n        // Remove all listeners on the transport and on self\n        const cleanup = () => {\n            transport.removeListener(\"open\", onTransportOpen);\n            transport.removeListener(\"error\", onerror);\n            transport.removeListener(\"close\", onTransportClose);\n            this.off(\"close\", onclose);\n            this.off(\"upgrading\", onupgrade);\n        };\n        transport.once(\"open\", onTransportOpen);\n        transport.once(\"error\", onerror);\n        transport.once(\"close\", onTransportClose);\n        this.once(\"close\", onclose);\n        this.once(\"upgrading\", onupgrade);\n        if (this.upgrades.indexOf(\"webtransport\") !== -1 &&\n            name !== \"webtransport\") {\n            // favor WebTransport\n            this.setTimeoutFn(() => {\n                if (!failed) {\n                    transport.open();\n                }\n            }, 200);\n        }\n        else {\n            transport.open();\n        }\n    }\n    /**\n     * Called when connection is deemed open.\n     *\n     * @private\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        Socket.priorWebsocketSuccess = \"websocket\" === this.transport.name;\n        this.emitReserved(\"open\");\n        this.flush();\n        // we check for `readyState` in case an `open`\n        // listener already closed the socket\n        if (\"open\" === this.readyState && this.opts.upgrade) {\n            let i = 0;\n            const l = this.upgrades.length;\n            for (; i < l; i++) {\n                this.probe(this.upgrades[i]);\n            }\n        }\n    }\n    /**\n     * Handles a packet.\n     *\n     * @private\n     */\n    onPacket(packet) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            this.emitReserved(\"packet\", packet);\n            // Socket is live - any packet counts\n            this.emitReserved(\"heartbeat\");\n            this.resetPingTimeout();\n            switch (packet.type) {\n                case \"open\":\n                    this.onHandshake(JSON.parse(packet.data));\n                    break;\n                case \"ping\":\n                    this.sendPacket(\"pong\");\n                    this.emitReserved(\"ping\");\n                    this.emitReserved(\"pong\");\n                    break;\n                case \"error\":\n                    const err = new Error(\"server error\");\n                    // @ts-ignore\n                    err.code = packet.data;\n                    this.onError(err);\n                    break;\n                case \"message\":\n                    this.emitReserved(\"data\", packet.data);\n                    this.emitReserved(\"message\", packet.data);\n                    break;\n            }\n        }\n        else {\n        }\n    }\n    /**\n     * Called upon handshake completion.\n     *\n     * @param {Object} data - handshake obj\n     * @private\n     */\n    onHandshake(data) {\n        this.emitReserved(\"handshake\", data);\n        this.id = data.sid;\n        this.transport.query.sid = data.sid;\n        this.upgrades = this.filterUpgrades(data.upgrades);\n        this.pingInterval = data.pingInterval;\n        this.pingTimeout = data.pingTimeout;\n        this.maxPayload = data.maxPayload;\n        this.onOpen();\n        // In case open handler closes socket\n        if (\"closed\" === this.readyState)\n            return;\n        this.resetPingTimeout();\n    }\n    /**\n     * Sets and resets ping timeout timer based on server pings.\n     *\n     * @private\n     */\n    resetPingTimeout() {\n        this.clearTimeoutFn(this.pingTimeoutTimer);\n        this.pingTimeoutTimer = this.setTimeoutFn(() => {\n            this.onClose(\"ping timeout\");\n        }, this.pingInterval + this.pingTimeout);\n        if (this.opts.autoUnref) {\n            this.pingTimeoutTimer.unref();\n        }\n    }\n    /**\n     * Called on `drain` event\n     *\n     * @private\n     */\n    onDrain() {\n        this.writeBuffer.splice(0, this.prevBufferLen);\n        // setting prevBufferLen = 0 is very important\n        // for example, when upgrading, upgrade packet is sent over,\n        // and a nonzero prevBufferLen could cause problems on `drain`\n        this.prevBufferLen = 0;\n        if (0 === this.writeBuffer.length) {\n            this.emitReserved(\"drain\");\n        }\n        else {\n            this.flush();\n        }\n    }\n    /**\n     * Flush write buffers.\n     *\n     * @private\n     */\n    flush() {\n        if (\"closed\" !== this.readyState &&\n            this.transport.writable &&\n            !this.upgrading &&\n            this.writeBuffer.length) {\n            const packets = this.getWritablePackets();\n            this.transport.send(packets);\n            // keep track of current length of writeBuffer\n            // splice writeBuffer and callbackBuffer on `drain`\n            this.prevBufferLen = packets.length;\n            this.emitReserved(\"flush\");\n        }\n    }\n    /**\n     * Ensure the encoded size of the writeBuffer is below the maxPayload value sent by the server (only for HTTP\n     * long-polling)\n     *\n     * @private\n     */\n    getWritablePackets() {\n        const shouldCheckPayloadSize = this.maxPayload &&\n            this.transport.name === \"polling\" &&\n            this.writeBuffer.length > 1;\n        if (!shouldCheckPayloadSize) {\n            return this.writeBuffer;\n        }\n        let payloadSize = 1; // first packet type\n        for (let i = 0; i < this.writeBuffer.length; i++) {\n            const data = this.writeBuffer[i].data;\n            if (data) {\n                payloadSize += byteLength(data);\n            }\n            if (i > 0 && payloadSize > this.maxPayload) {\n                return this.writeBuffer.slice(0, i);\n            }\n            payloadSize += 2; // separator + packet type\n        }\n        return this.writeBuffer;\n    }\n    /**\n     * Sends a message.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} callback function.\n     * @return {Socket} for chaining.\n     */\n    write(msg, options, fn) {\n        this.sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    send(msg, options, fn) {\n        this.sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param {String} type: packet type.\n     * @param {String} data.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @private\n     */\n    sendPacket(type, data, options, fn) {\n        if (\"function\" === typeof data) {\n            fn = data;\n            data = undefined;\n        }\n        if (\"function\" === typeof options) {\n            fn = options;\n            options = null;\n        }\n        if (\"closing\" === this.readyState || \"closed\" === this.readyState) {\n            return;\n        }\n        options = options || {};\n        options.compress = false !== options.compress;\n        const packet = {\n            type: type,\n            data: data,\n            options: options,\n        };\n        this.emitReserved(\"packetCreate\", packet);\n        this.writeBuffer.push(packet);\n        if (fn)\n            this.once(\"flush\", fn);\n        this.flush();\n    }\n    /**\n     * Closes the connection.\n     */\n    close() {\n        const close = () => {\n            this.onClose(\"forced close\");\n            this.transport.close();\n        };\n        const cleanupAndClose = () => {\n            this.off(\"upgrade\", cleanupAndClose);\n            this.off(\"upgradeError\", cleanupAndClose);\n            close();\n        };\n        const waitForUpgrade = () => {\n            // wait for upgrade to finish since we can't send packets while pausing a transport\n            this.once(\"upgrade\", cleanupAndClose);\n            this.once(\"upgradeError\", cleanupAndClose);\n        };\n        if (\"opening\" === this.readyState || \"open\" === this.readyState) {\n            this.readyState = \"closing\";\n            if (this.writeBuffer.length) {\n                this.once(\"drain\", () => {\n                    if (this.upgrading) {\n                        waitForUpgrade();\n                    }\n                    else {\n                        close();\n                    }\n                });\n            }\n            else if (this.upgrading) {\n                waitForUpgrade();\n            }\n            else {\n                close();\n            }\n        }\n        return this;\n    }\n    /**\n     * Called upon transport error\n     *\n     * @private\n     */\n    onError(err) {\n        Socket.priorWebsocketSuccess = false;\n        this.emitReserved(\"error\", err);\n        this.onClose(\"transport error\", err);\n    }\n    /**\n     * Called upon transport close.\n     *\n     * @private\n     */\n    onClose(reason, description) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            // clear timers\n            this.clearTimeoutFn(this.pingTimeoutTimer);\n            // stop event from firing again for transport\n            this.transport.removeAllListeners(\"close\");\n            // ensure transport won't stay open\n            this.transport.close();\n            // ignore further transport communication\n            this.transport.removeAllListeners();\n            if (typeof removeEventListener === \"function\") {\n                removeEventListener(\"beforeunload\", this.beforeunloadEventListener, false);\n                removeEventListener(\"offline\", this.offlineEventListener, false);\n            }\n            // set ready state\n            this.readyState = \"closed\";\n            // clear session id\n            this.id = null;\n            // emit close event\n            this.emitReserved(\"close\", reason, description);\n            // clean buffers after, so users can still\n            // grab the buffers on `close` event\n            this.writeBuffer = [];\n            this.prevBufferLen = 0;\n        }\n    }\n    /**\n     * Filters upgrades, returning only those matching client transports.\n     *\n     * @param {Array} upgrades - server upgrades\n     * @private\n     */\n    filterUpgrades(upgrades) {\n        const filteredUpgrades = [];\n        let i = 0;\n        const j = upgrades.length;\n        for (; i < j; i++) {\n            if (~this.transports.indexOf(upgrades[i]))\n                filteredUpgrades.push(upgrades[i]);\n        }\n        return filteredUpgrades;\n    }\n}\nSocket.protocol = protocol;\n","import { Socket } from \"./socket.js\";\nexport { Socket };\nexport const protocol = Socket.protocol;\nexport { Transport, TransportError } from \"./transport.js\";\nexport { transports } from \"./transports/index.js\";\nexport { installTimerFunctions } from \"./util.js\";\nexport { parse } from \"./contrib/parseuri.js\";\nexport { nextTick } from \"./transports/websocket-constructor.js\";\n","const withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj.buffer instanceof ArrayBuffer;\n};\nconst toString = Object.prototype.toString;\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeFile = typeof File === \"function\" ||\n    (typeof File !== \"undefined\" &&\n        toString.call(File) === \"[object FileConstructor]\");\n/**\n * Returns true if obj is a Buffer, an ArrayBuffer, a Blob or a File.\n *\n * @private\n */\nexport function isBinary(obj) {\n    return ((withNativeArrayBuffer && (obj instanceof ArrayBuffer || isView(obj))) ||\n        (withNativeBlob && obj instanceof Blob) ||\n        (withNativeFile && obj instanceof File));\n}\nexport function hasBinary(obj, toJSON) {\n    if (!obj || typeof obj !== \"object\") {\n        return false;\n    }\n    if (Array.isArray(obj)) {\n        for (let i = 0, l = obj.length; i < l; i++) {\n            if (hasBinary(obj[i])) {\n                return true;\n            }\n        }\n        return false;\n    }\n    if (isBinary(obj)) {\n        return true;\n    }\n    if (obj.toJSON &&\n        typeof obj.toJSON === \"function\" &&\n        arguments.length === 1) {\n        return hasBinary(obj.toJSON(), true);\n    }\n    for (const key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key) && hasBinary(obj[key])) {\n            return true;\n        }\n    }\n    return false;\n}\n","import { isBinary } from \"./is-binary.js\";\n/**\n * Replaces every Buffer | ArrayBuffer | Blob | File in packet with a numbered placeholder.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @public\n */\nexport function deconstructPacket(packet) {\n    const buffers = [];\n    const packetData = packet.data;\n    const pack = packet;\n    pack.data = _deconstructPacket(packetData, buffers);\n    pack.attachments = buffers.length; // number of binary 'attachments'\n    return { packet: pack, buffers: buffers };\n}\nfunction _deconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (isBinary(data)) {\n        const placeholder = { _placeholder: true, num: buffers.length };\n        buffers.push(data);\n        return placeholder;\n    }\n    else if (Array.isArray(data)) {\n        const newData = new Array(data.length);\n        for (let i = 0; i < data.length; i++) {\n            newData[i] = _deconstructPacket(data[i], buffers);\n        }\n        return newData;\n    }\n    else if (typeof data === \"object\" && !(data instanceof Date)) {\n        const newData = {};\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                newData[key] = _deconstructPacket(data[key], buffers);\n            }\n        }\n        return newData;\n    }\n    return data;\n}\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @public\n */\nexport function reconstructPacket(packet, buffers) {\n    packet.data = _reconstructPacket(packet.data, buffers);\n    delete packet.attachments; // no longer useful\n    return packet;\n}\nfunction _reconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (data && data._placeholder === true) {\n        const isIndexValid = typeof data.num === \"number\" &&\n            data.num >= 0 &&\n            data.num < buffers.length;\n        if (isIndexValid) {\n            return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n        }\n        else {\n            throw new Error(\"illegal attachments\");\n        }\n    }\n    else if (Array.isArray(data)) {\n        for (let i = 0; i < data.length; i++) {\n            data[i] = _reconstructPacket(data[i], buffers);\n        }\n    }\n    else if (typeof data === \"object\") {\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                data[key] = _reconstructPacket(data[key], buffers);\n            }\n        }\n    }\n    return data;\n}\n","import { Emitter } from \"@socket.io/component-emitter\";\nimport { deconstructPacket, reconstructPacket } from \"./binary.js\";\nimport { isBinary, hasBinary } from \"./is-binary.js\";\n/**\n * These strings must not be used as event names, as they have a special meaning.\n */\nconst RESERVED_EVENTS = [\n    \"connect\",\n    \"connect_error\",\n    \"disconnect\",\n    \"disconnecting\",\n    \"newListener\",\n    \"removeListener\", // used by the Node.js EventEmitter\n];\n/**\n * Protocol version.\n *\n * @public\n */\nexport const protocol = 5;\nexport var PacketType;\n(function (PacketType) {\n    PacketType[PacketType[\"CONNECT\"] = 0] = \"CONNECT\";\n    PacketType[PacketType[\"DISCONNECT\"] = 1] = \"DISCONNECT\";\n    PacketType[PacketType[\"EVENT\"] = 2] = \"EVENT\";\n    PacketType[PacketType[\"ACK\"] = 3] = \"ACK\";\n    PacketType[PacketType[\"CONNECT_ERROR\"] = 4] = \"CONNECT_ERROR\";\n    PacketType[PacketType[\"BINARY_EVENT\"] = 5] = \"BINARY_EVENT\";\n    PacketType[PacketType[\"BINARY_ACK\"] = 6] = \"BINARY_ACK\";\n})(PacketType || (PacketType = {}));\n/**\n * A socket.io Encoder instance\n */\nexport class Encoder {\n    /**\n     * Encoder constructor\n     *\n     * @param {function} replacer - custom replacer to pass down to JSON.parse\n     */\n    constructor(replacer) {\n        this.replacer = replacer;\n    }\n    /**\n     * Encode a packet as a single string if non-binary, or as a\n     * buffer sequence, depending on packet type.\n     *\n     * @param {Object} obj - packet object\n     */\n    encode(obj) {\n        if (obj.type === PacketType.EVENT || obj.type === PacketType.ACK) {\n            if (hasBinary(obj)) {\n                return this.encodeAsBinary({\n                    type: obj.type === PacketType.EVENT\n                        ? PacketType.BINARY_EVENT\n                        : PacketType.BINARY_ACK,\n                    nsp: obj.nsp,\n                    data: obj.data,\n                    id: obj.id,\n                });\n            }\n        }\n        return [this.encodeAsString(obj)];\n    }\n    /**\n     * Encode packet as string.\n     */\n    encodeAsString(obj) {\n        // first is type\n        let str = \"\" + obj.type;\n        // attachments if we have them\n        if (obj.type === PacketType.BINARY_EVENT ||\n            obj.type === PacketType.BINARY_ACK) {\n            str += obj.attachments + \"-\";\n        }\n        // if we have a namespace other than `/`\n        // we append it followed by a comma `,`\n        if (obj.nsp && \"/\" !== obj.nsp) {\n            str += obj.nsp + \",\";\n        }\n        // immediately followed by the id\n        if (null != obj.id) {\n            str += obj.id;\n        }\n        // json data\n        if (null != obj.data) {\n            str += JSON.stringify(obj.data, this.replacer);\n        }\n        return str;\n    }\n    /**\n     * Encode packet as 'buffer sequence' by removing blobs, and\n     * deconstructing packet into object with placeholders and\n     * a list of buffers.\n     */\n    encodeAsBinary(obj) {\n        const deconstruction = deconstructPacket(obj);\n        const pack = this.encodeAsString(deconstruction.packet);\n        const buffers = deconstruction.buffers;\n        buffers.unshift(pack); // add packet info to beginning of data list\n        return buffers; // write all the buffers\n    }\n}\n// see https://stackoverflow.com/questions/8511281/check-if-a-value-is-an-object-in-javascript\nfunction isObject(value) {\n    return Object.prototype.toString.call(value) === \"[object Object]\";\n}\n/**\n * A socket.io Decoder instance\n *\n * @return {Object} decoder\n */\nexport class Decoder extends Emitter {\n    /**\n     * Decoder constructor\n     *\n     * @param {function} reviver - custom reviver to pass down to JSON.stringify\n     */\n    constructor(reviver) {\n        super();\n        this.reviver = reviver;\n    }\n    /**\n     * Decodes an encoded packet string into packet JSON.\n     *\n     * @param {String} obj - encoded packet\n     */\n    add(obj) {\n        let packet;\n        if (typeof obj === \"string\") {\n            if (this.reconstructor) {\n                throw new Error(\"got plaintext data when reconstructing a packet\");\n            }\n            packet = this.decodeString(obj);\n            const isBinaryEvent = packet.type === PacketType.BINARY_EVENT;\n            if (isBinaryEvent || packet.type === PacketType.BINARY_ACK) {\n                packet.type = isBinaryEvent ? PacketType.EVENT : PacketType.ACK;\n                // binary packet's json\n                this.reconstructor = new BinaryReconstructor(packet);\n                // no attachments, labeled binary but no binary data to follow\n                if (packet.attachments === 0) {\n                    super.emitReserved(\"decoded\", packet);\n                }\n            }\n            else {\n                // non-binary full packet\n                super.emitReserved(\"decoded\", packet);\n            }\n        }\n        else if (isBinary(obj) || obj.base64) {\n            // raw binary data\n            if (!this.reconstructor) {\n                throw new Error(\"got binary data when not reconstructing a packet\");\n            }\n            else {\n                packet = this.reconstructor.takeBinaryData(obj);\n                if (packet) {\n                    // received final buffer\n                    this.reconstructor = null;\n                    super.emitReserved(\"decoded\", packet);\n                }\n            }\n        }\n        else {\n            throw new Error(\"Unknown type: \" + obj);\n        }\n    }\n    /**\n     * Decode a packet String (JSON data)\n     *\n     * @param {String} str\n     * @return {Object} packet\n     */\n    decodeString(str) {\n        let i = 0;\n        // look up type\n        const p = {\n            type: Number(str.charAt(0)),\n        };\n        if (PacketType[p.type] === undefined) {\n            throw new Error(\"unknown packet type \" + p.type);\n        }\n        // look up attachments if type binary\n        if (p.type === PacketType.BINARY_EVENT ||\n            p.type === PacketType.BINARY_ACK) {\n            const start = i + 1;\n            while (str.charAt(++i) !== \"-\" && i != str.length) { }\n            const buf = str.substring(start, i);\n            if (buf != Number(buf) || str.charAt(i) !== \"-\") {\n                throw new Error(\"Illegal attachments\");\n            }\n            p.attachments = Number(buf);\n        }\n        // look up namespace (if any)\n        if (\"/\" === str.charAt(i + 1)) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (\",\" === c)\n                    break;\n                if (i === str.length)\n                    break;\n            }\n            p.nsp = str.substring(start, i);\n        }\n        else {\n            p.nsp = \"/\";\n        }\n        // look up id\n        const next = str.charAt(i + 1);\n        if (\"\" !== next && Number(next) == next) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (null == c || Number(c) != c) {\n                    --i;\n                    break;\n                }\n                if (i === str.length)\n                    break;\n            }\n            p.id = Number(str.substring(start, i + 1));\n        }\n        // look up json data\n        if (str.charAt(++i)) {\n            const payload = this.tryParse(str.substr(i));\n            if (Decoder.isPayloadValid(p.type, payload)) {\n                p.data = payload;\n            }\n            else {\n                throw new Error(\"invalid payload\");\n            }\n        }\n        return p;\n    }\n    tryParse(str) {\n        try {\n            return JSON.parse(str, this.reviver);\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    static isPayloadValid(type, payload) {\n        switch (type) {\n            case PacketType.CONNECT:\n                return isObject(payload);\n            case PacketType.DISCONNECT:\n                return payload === undefined;\n            case PacketType.CONNECT_ERROR:\n                return typeof payload === \"string\" || isObject(payload);\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                return (Array.isArray(payload) &&\n                    (typeof payload[0] === \"number\" ||\n                        (typeof payload[0] === \"string\" &&\n                            RESERVED_EVENTS.indexOf(payload[0]) === -1)));\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                return Array.isArray(payload);\n        }\n    }\n    /**\n     * Deallocates a parser's resources\n     */\n    destroy() {\n        if (this.reconstructor) {\n            this.reconstructor.finishedReconstruction();\n            this.reconstructor = null;\n        }\n    }\n}\n/**\n * A manager of a binary event's 'buffer sequence'. Should\n * be constructed whenever a packet of type BINARY_EVENT is\n * decoded.\n *\n * @param {Object} packet\n * @return {BinaryReconstructor} initialized reconstructor\n */\nclass BinaryReconstructor {\n    constructor(packet) {\n        this.packet = packet;\n        this.buffers = [];\n        this.reconPack = packet;\n    }\n    /**\n     * Method to be called when binary data received from connection\n     * after a BINARY_EVENT packet.\n     *\n     * @param {Buffer | ArrayBuffer} binData - the raw binary data received\n     * @return {null | Object} returns null if more binary data is expected or\n     *   a reconstructed packet object if all buffers have been received.\n     */\n    takeBinaryData(binData) {\n        this.buffers.push(binData);\n        if (this.buffers.length === this.reconPack.attachments) {\n            // done with buffer list\n            const packet = reconstructPacket(this.reconPack, this.buffers);\n            this.finishedReconstruction();\n            return packet;\n        }\n        return null;\n    }\n    /**\n     * Cleans up binary packet reconstruction variables.\n     */\n    finishedReconstruction() {\n        this.reconPack = null;\n        this.buffers = [];\n    }\n}\n","export function on(obj, ev, fn) {\n    obj.on(ev, fn);\n    return function subDestroy() {\n        obj.off(ev, fn);\n    };\n}\n","import { PacketType } from \"socket.io-parser\";\nimport { on } from \"./on.js\";\nimport { Emitter, } from \"@socket.io/component-emitter\";\n/**\n * Internal events.\n * These events can't be emitted by the user.\n */\nconst RESERVED_EVENTS = Object.freeze({\n    connect: 1,\n    connect_error: 1,\n    disconnect: 1,\n    disconnecting: 1,\n    // EventEmitter reserved events: https://nodejs.org/api/events.html#events_event_newlistener\n    newListener: 1,\n    removeListener: 1,\n});\n/**\n * A Socket is the fundamental class for interacting with the server.\n *\n * A Socket belongs to a certain Namespace (by default /) and uses an underlying {@link Manager} to communicate.\n *\n * @example\n * const socket = io();\n *\n * socket.on(\"connect\", () => {\n *   console.log(\"connected\");\n * });\n *\n * // send an event to the server\n * socket.emit(\"foo\", \"bar\");\n *\n * socket.on(\"foobar\", () => {\n *   // an event was received from the server\n * });\n *\n * // upon disconnection\n * socket.on(\"disconnect\", (reason) => {\n *   console.log(`disconnected due to ${reason}`);\n * });\n */\nexport class Socket extends Emitter {\n    /**\n     * `Socket` constructor.\n     */\n    constructor(io, nsp, opts) {\n        super();\n        /**\n         * Whether the socket is currently connected to the server.\n         *\n         * @example\n         * const socket = io();\n         *\n         * socket.on(\"connect\", () => {\n         *   console.log(socket.connected); // true\n         * });\n         *\n         * socket.on(\"disconnect\", () => {\n         *   console.log(socket.connected); // false\n         * });\n         */\n        this.connected = false;\n        /**\n         * Whether the connection state was recovered after a temporary disconnection. In that case, any missed packets will\n         * be transmitted by the server.\n         */\n        this.recovered = false;\n        /**\n         * Buffer for packets received before the CONNECT packet\n         */\n        this.receiveBuffer = [];\n        /**\n         * Buffer for packets that will be sent once the socket is connected\n         */\n        this.sendBuffer = [];\n        /**\n         * The queue of packets to be sent with retry in case of failure.\n         *\n         * Packets are sent one by one, each waiting for the server acknowledgement, in order to guarantee the delivery order.\n         * @private\n         */\n        this._queue = [];\n        /**\n         * A sequence to generate the ID of the {@link QueuedPacket}.\n         * @private\n         */\n        this._queueSeq = 0;\n        this.ids = 0;\n        this.acks = {};\n        this.flags = {};\n        this.io = io;\n        this.nsp = nsp;\n        if (opts && opts.auth) {\n            this.auth = opts.auth;\n        }\n        this._opts = Object.assign({}, opts);\n        if (this.io._autoConnect)\n            this.open();\n    }\n    /**\n     * Whether the socket is currently disconnected\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on(\"connect\", () => {\n     *   console.log(socket.disconnected); // false\n     * });\n     *\n     * socket.on(\"disconnect\", () => {\n     *   console.log(socket.disconnected); // true\n     * });\n     */\n    get disconnected() {\n        return !this.connected;\n    }\n    /**\n     * Subscribe to open, close and packet events\n     *\n     * @private\n     */\n    subEvents() {\n        if (this.subs)\n            return;\n        const io = this.io;\n        this.subs = [\n            on(io, \"open\", this.onopen.bind(this)),\n            on(io, \"packet\", this.onpacket.bind(this)),\n            on(io, \"error\", this.onerror.bind(this)),\n            on(io, \"close\", this.onclose.bind(this)),\n        ];\n    }\n    /**\n     * Whether the Socket will try to reconnect when its Manager connects or reconnects.\n     *\n     * @example\n     * const socket = io();\n     *\n     * console.log(socket.active); // true\n     *\n     * socket.on(\"disconnect\", (reason) => {\n     *   if (reason === \"io server disconnect\") {\n     *     // the disconnection was initiated by the server, you need to manually reconnect\n     *     console.log(socket.active); // false\n     *   }\n     *   // else the socket will automatically try to reconnect\n     *   console.log(socket.active); // true\n     * });\n     */\n    get active() {\n        return !!this.subs;\n    }\n    /**\n     * \"Opens\" the socket.\n     *\n     * @example\n     * const socket = io({\n     *   autoConnect: false\n     * });\n     *\n     * socket.connect();\n     */\n    connect() {\n        if (this.connected)\n            return this;\n        this.subEvents();\n        if (!this.io[\"_reconnecting\"])\n            this.io.open(); // ensure open\n        if (\"open\" === this.io._readyState)\n            this.onopen();\n        return this;\n    }\n    /**\n     * Alias for {@link connect()}.\n     */\n    open() {\n        return this.connect();\n    }\n    /**\n     * Sends a `message` event.\n     *\n     * This method mimics the WebSocket.send() method.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/send\n     *\n     * @example\n     * socket.send(\"hello\");\n     *\n     * // this is equivalent to\n     * socket.emit(\"message\", \"hello\");\n     *\n     * @return self\n     */\n    send(...args) {\n        args.unshift(\"message\");\n        this.emit.apply(this, args);\n        return this;\n    }\n    /**\n     * Override `emit`.\n     * If the event is in `events`, it's emitted normally.\n     *\n     * @example\n     * socket.emit(\"hello\", \"world\");\n     *\n     * // all serializable datastructures are supported (no need to call JSON.stringify)\n     * socket.emit(\"hello\", 1, \"2\", { 3: [\"4\"], 5: Uint8Array.from([6]) });\n     *\n     * // with an acknowledgement from the server\n     * socket.emit(\"hello\", \"world\", (val) => {\n     *   // ...\n     * });\n     *\n     * @return self\n     */\n    emit(ev, ...args) {\n        if (RESERVED_EVENTS.hasOwnProperty(ev)) {\n            throw new Error('\"' + ev.toString() + '\" is a reserved event name');\n        }\n        args.unshift(ev);\n        if (this._opts.retries && !this.flags.fromQueue && !this.flags.volatile) {\n            this._addToQueue(args);\n            return this;\n        }\n        const packet = {\n            type: PacketType.EVENT,\n            data: args,\n        };\n        packet.options = {};\n        packet.options.compress = this.flags.compress !== false;\n        // event ack callback\n        if (\"function\" === typeof args[args.length - 1]) {\n            const id = this.ids++;\n            const ack = args.pop();\n            this._registerAckCallback(id, ack);\n            packet.id = id;\n        }\n        const isTransportWritable = this.io.engine &&\n            this.io.engine.transport &&\n            this.io.engine.transport.writable;\n        const discardPacket = this.flags.volatile && (!isTransportWritable || !this.connected);\n        if (discardPacket) {\n        }\n        else if (this.connected) {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        }\n        else {\n            this.sendBuffer.push(packet);\n        }\n        this.flags = {};\n        return this;\n    }\n    /**\n     * @private\n     */\n    _registerAckCallback(id, ack) {\n        var _a;\n        const timeout = (_a = this.flags.timeout) !== null && _a !== void 0 ? _a : this._opts.ackTimeout;\n        if (timeout === undefined) {\n            this.acks[id] = ack;\n            return;\n        }\n        // @ts-ignore\n        const timer = this.io.setTimeoutFn(() => {\n            delete this.acks[id];\n            for (let i = 0; i < this.sendBuffer.length; i++) {\n                if (this.sendBuffer[i].id === id) {\n                    this.sendBuffer.splice(i, 1);\n                }\n            }\n            ack.call(this, new Error(\"operation has timed out\"));\n        }, timeout);\n        this.acks[id] = (...args) => {\n            // @ts-ignore\n            this.io.clearTimeoutFn(timer);\n            ack.apply(this, [null, ...args]);\n        };\n    }\n    /**\n     * Emits an event and waits for an acknowledgement\n     *\n     * @example\n     * // without timeout\n     * const response = await socket.emitWithAck(\"hello\", \"world\");\n     *\n     * // with a specific timeout\n     * try {\n     *   const response = await socket.timeout(1000).emitWithAck(\"hello\", \"world\");\n     * } catch (err) {\n     *   // the server did not acknowledge the event in the given delay\n     * }\n     *\n     * @return a Promise that will be fulfilled when the server acknowledges the event\n     */\n    emitWithAck(ev, ...args) {\n        // the timeout flag is optional\n        const withErr = this.flags.timeout !== undefined || this._opts.ackTimeout !== undefined;\n        return new Promise((resolve, reject) => {\n            args.push((arg1, arg2) => {\n                if (withErr) {\n                    return arg1 ? reject(arg1) : resolve(arg2);\n                }\n                else {\n                    return resolve(arg1);\n                }\n            });\n            this.emit(ev, ...args);\n        });\n    }\n    /**\n     * Add the packet to the queue.\n     * @param args\n     * @private\n     */\n    _addToQueue(args) {\n        let ack;\n        if (typeof args[args.length - 1] === \"function\") {\n            ack = args.pop();\n        }\n        const packet = {\n            id: this._queueSeq++,\n            tryCount: 0,\n            pending: false,\n            args,\n            flags: Object.assign({ fromQueue: true }, this.flags),\n        };\n        args.push((err, ...responseArgs) => {\n            if (packet !== this._queue[0]) {\n                // the packet has already been acknowledged\n                return;\n            }\n            const hasError = err !== null;\n            if (hasError) {\n                if (packet.tryCount > this._opts.retries) {\n                    this._queue.shift();\n                    if (ack) {\n                        ack(err);\n                    }\n                }\n            }\n            else {\n                this._queue.shift();\n                if (ack) {\n                    ack(null, ...responseArgs);\n                }\n            }\n            packet.pending = false;\n            return this._drainQueue();\n        });\n        this._queue.push(packet);\n        this._drainQueue();\n    }\n    /**\n     * Send the first packet of the queue, and wait for an acknowledgement from the server.\n     * @param force - whether to resend a packet that has not been acknowledged yet\n     *\n     * @private\n     */\n    _drainQueue(force = false) {\n        if (!this.connected || this._queue.length === 0) {\n            return;\n        }\n        const packet = this._queue[0];\n        if (packet.pending && !force) {\n            return;\n        }\n        packet.pending = true;\n        packet.tryCount++;\n        this.flags = packet.flags;\n        this.emit.apply(this, packet.args);\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param packet\n     * @private\n     */\n    packet(packet) {\n        packet.nsp = this.nsp;\n        this.io._packet(packet);\n    }\n    /**\n     * Called upon engine `open`.\n     *\n     * @private\n     */\n    onopen() {\n        if (typeof this.auth == \"function\") {\n            this.auth((data) => {\n                this._sendConnectPacket(data);\n            });\n        }\n        else {\n            this._sendConnectPacket(this.auth);\n        }\n    }\n    /**\n     * Sends a CONNECT packet to initiate the Socket.IO session.\n     *\n     * @param data\n     * @private\n     */\n    _sendConnectPacket(data) {\n        this.packet({\n            type: PacketType.CONNECT,\n            data: this._pid\n                ? Object.assign({ pid: this._pid, offset: this._lastOffset }, data)\n                : data,\n        });\n    }\n    /**\n     * Called upon engine or manager `error`.\n     *\n     * @param err\n     * @private\n     */\n    onerror(err) {\n        if (!this.connected) {\n            this.emitReserved(\"connect_error\", err);\n        }\n    }\n    /**\n     * Called upon engine `close`.\n     *\n     * @param reason\n     * @param description\n     * @private\n     */\n    onclose(reason, description) {\n        this.connected = false;\n        delete this.id;\n        this.emitReserved(\"disconnect\", reason, description);\n    }\n    /**\n     * Called with socket packet.\n     *\n     * @param packet\n     * @private\n     */\n    onpacket(packet) {\n        const sameNamespace = packet.nsp === this.nsp;\n        if (!sameNamespace)\n            return;\n        switch (packet.type) {\n            case PacketType.CONNECT:\n                if (packet.data && packet.data.sid) {\n                    this.onconnect(packet.data.sid, packet.data.pid);\n                }\n                else {\n                    this.emitReserved(\"connect_error\", new Error(\"It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)\"));\n                }\n                break;\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                this.onevent(packet);\n                break;\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                this.onack(packet);\n                break;\n            case PacketType.DISCONNECT:\n                this.ondisconnect();\n                break;\n            case PacketType.CONNECT_ERROR:\n                this.destroy();\n                const err = new Error(packet.data.message);\n                // @ts-ignore\n                err.data = packet.data.data;\n                this.emitReserved(\"connect_error\", err);\n                break;\n        }\n    }\n    /**\n     * Called upon a server event.\n     *\n     * @param packet\n     * @private\n     */\n    onevent(packet) {\n        const args = packet.data || [];\n        if (null != packet.id) {\n            args.push(this.ack(packet.id));\n        }\n        if (this.connected) {\n            this.emitEvent(args);\n        }\n        else {\n            this.receiveBuffer.push(Object.freeze(args));\n        }\n    }\n    emitEvent(args) {\n        if (this._anyListeners && this._anyListeners.length) {\n            const listeners = this._anyListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, args);\n            }\n        }\n        super.emit.apply(this, args);\n        if (this._pid && args.length && typeof args[args.length - 1] === \"string\") {\n            this._lastOffset = args[args.length - 1];\n        }\n    }\n    /**\n     * Produces an ack callback to emit with an event.\n     *\n     * @private\n     */\n    ack(id) {\n        const self = this;\n        let sent = false;\n        return function (...args) {\n            // prevent double callbacks\n            if (sent)\n                return;\n            sent = true;\n            self.packet({\n                type: PacketType.ACK,\n                id: id,\n                data: args,\n            });\n        };\n    }\n    /**\n     * Called upon a server acknowlegement.\n     *\n     * @param packet\n     * @private\n     */\n    onack(packet) {\n        const ack = this.acks[packet.id];\n        if (\"function\" === typeof ack) {\n            ack.apply(this, packet.data);\n            delete this.acks[packet.id];\n        }\n        else {\n        }\n    }\n    /**\n     * Called upon server connect.\n     *\n     * @private\n     */\n    onconnect(id, pid) {\n        this.id = id;\n        this.recovered = pid && this._pid === pid;\n        this._pid = pid; // defined only if connection state recovery is enabled\n        this.connected = true;\n        this.emitBuffered();\n        this.emitReserved(\"connect\");\n        this._drainQueue(true);\n    }\n    /**\n     * Emit buffered events (received and emitted).\n     *\n     * @private\n     */\n    emitBuffered() {\n        this.receiveBuffer.forEach((args) => this.emitEvent(args));\n        this.receiveBuffer = [];\n        this.sendBuffer.forEach((packet) => {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        });\n        this.sendBuffer = [];\n    }\n    /**\n     * Called upon server disconnect.\n     *\n     * @private\n     */\n    ondisconnect() {\n        this.destroy();\n        this.onclose(\"io server disconnect\");\n    }\n    /**\n     * Called upon forced client/server side disconnections,\n     * this method ensures the manager stops tracking us and\n     * that reconnections don't get triggered for this.\n     *\n     * @private\n     */\n    destroy() {\n        if (this.subs) {\n            // clean subscriptions to avoid reconnections\n            this.subs.forEach((subDestroy) => subDestroy());\n            this.subs = undefined;\n        }\n        this.io[\"_destroy\"](this);\n    }\n    /**\n     * Disconnects the socket manually. In that case, the socket will not try to reconnect.\n     *\n     * If this is the last active Socket instance of the {@link Manager}, the low-level connection will be closed.\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on(\"disconnect\", (reason) => {\n     *   // console.log(reason); prints \"io client disconnect\"\n     * });\n     *\n     * socket.disconnect();\n     *\n     * @return self\n     */\n    disconnect() {\n        if (this.connected) {\n            this.packet({ type: PacketType.DISCONNECT });\n        }\n        // remove socket from pool\n        this.destroy();\n        if (this.connected) {\n            // fire events\n            this.onclose(\"io client disconnect\");\n        }\n        return this;\n    }\n    /**\n     * Alias for {@link disconnect()}.\n     *\n     * @return self\n     */\n    close() {\n        return this.disconnect();\n    }\n    /**\n     * Sets the compress flag.\n     *\n     * @example\n     * socket.compress(false).emit(\"hello\");\n     *\n     * @param compress - if `true`, compresses the sending data\n     * @return self\n     */\n    compress(compress) {\n        this.flags.compress = compress;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the event message will be dropped when this socket is not\n     * ready to send messages.\n     *\n     * @example\n     * socket.volatile.emit(\"hello\"); // the server may or may not receive it\n     *\n     * @returns self\n     */\n    get volatile() {\n        this.flags.volatile = true;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the callback will be called with an error when the\n     * given number of milliseconds have elapsed without an acknowledgement from the server:\n     *\n     * @example\n     * socket.timeout(5000).emit(\"my-event\", (err) => {\n     *   if (err) {\n     *     // the server did not acknowledge the event in the given delay\n     *   }\n     * });\n     *\n     * @returns self\n     */\n    timeout(timeout) {\n        this.flags.timeout = timeout;\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * @example\n     * socket.onAny((event, ...args) => {\n     *   console.log(`got ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * @example\n     * socket.prependAny((event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * }\n     *\n     * socket.onAny(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAny(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAny();\n     *\n     * @param listener\n     */\n    offAny(listener) {\n        if (!this._anyListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAny() {\n        return this._anyListeners || [];\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.onAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.prependAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * }\n     *\n     * socket.onAnyOutgoing(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAnyOutgoing(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAnyOutgoing();\n     *\n     * @param [listener] - the catch-all listener (optional)\n     */\n    offAnyOutgoing(listener) {\n        if (!this._anyOutgoingListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyOutgoingListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyOutgoingListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAnyOutgoing() {\n        return this._anyOutgoingListeners || [];\n    }\n    /**\n     * Notify the listeners for each packet sent\n     *\n     * @param packet\n     *\n     * @private\n     */\n    notifyOutgoingListeners(packet) {\n        if (this._anyOutgoingListeners && this._anyOutgoingListeners.length) {\n            const listeners = this._anyOutgoingListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, packet.data);\n            }\n        }\n    }\n}\n","/**\n * Initialize backoff timer with `opts`.\n *\n * - `min` initial timeout in milliseconds [100]\n * - `max` max timeout [10000]\n * - `jitter` [0]\n * - `factor` [2]\n *\n * @param {Object} opts\n * @api public\n */\nexport function Backoff(opts) {\n    opts = opts || {};\n    this.ms = opts.min || 100;\n    this.max = opts.max || 10000;\n    this.factor = opts.factor || 2;\n    this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;\n    this.attempts = 0;\n}\n/**\n * Return the backoff duration.\n *\n * @return {Number}\n * @api public\n */\nBackoff.prototype.duration = function () {\n    var ms = this.ms * Math.pow(this.factor, this.attempts++);\n    if (this.jitter) {\n        var rand = Math.random();\n        var deviation = Math.floor(rand * this.jitter * ms);\n        ms = (Math.floor(rand * 10) & 1) == 0 ? ms - deviation : ms + deviation;\n    }\n    return Math.min(ms, this.max) | 0;\n};\n/**\n * Reset the number of attempts.\n *\n * @api public\n */\nBackoff.prototype.reset = function () {\n    this.attempts = 0;\n};\n/**\n * Set the minimum duration\n *\n * @api public\n */\nBackoff.prototype.setMin = function (min) {\n    this.ms = min;\n};\n/**\n * Set the maximum duration\n *\n * @api public\n */\nBackoff.prototype.setMax = function (max) {\n    this.max = max;\n};\n/**\n * Set the jitter\n *\n * @api public\n */\nBackoff.prototype.setJitter = function (jitter) {\n    this.jitter = jitter;\n};\n","import { Socket as Engine, installTimerFunctions, nextTick, } from \"engine.io-client\";\nimport { Socket } from \"./socket.js\";\nimport * as parser from \"socket.io-parser\";\nimport { on } from \"./on.js\";\nimport { Backoff } from \"./contrib/backo2.js\";\nimport { Emitter, } from \"@socket.io/component-emitter\";\nexport class Manager extends Emitter {\n    constructor(uri, opts) {\n        var _a;\n        super();\n        this.nsps = {};\n        this.subs = [];\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = undefined;\n        }\n        opts = opts || {};\n        opts.path = opts.path || \"/socket.io\";\n        this.opts = opts;\n        installTimerFunctions(this, opts);\n        this.reconnection(opts.reconnection !== false);\n        this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n        this.reconnectionDelay(opts.reconnectionDelay || 1000);\n        this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n        this.randomizationFactor((_a = opts.randomizationFactor) !== null && _a !== void 0 ? _a : 0.5);\n        this.backoff = new Backoff({\n            min: this.reconnectionDelay(),\n            max: this.reconnectionDelayMax(),\n            jitter: this.randomizationFactor(),\n        });\n        this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n        this._readyState = \"closed\";\n        this.uri = uri;\n        const _parser = opts.parser || parser;\n        this.encoder = new _parser.Encoder();\n        this.decoder = new _parser.Decoder();\n        this._autoConnect = opts.autoConnect !== false;\n        if (this._autoConnect)\n            this.open();\n    }\n    reconnection(v) {\n        if (!arguments.length)\n            return this._reconnection;\n        this._reconnection = !!v;\n        return this;\n    }\n    reconnectionAttempts(v) {\n        if (v === undefined)\n            return this._reconnectionAttempts;\n        this._reconnectionAttempts = v;\n        return this;\n    }\n    reconnectionDelay(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelay;\n        this._reconnectionDelay = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMin(v);\n        return this;\n    }\n    randomizationFactor(v) {\n        var _a;\n        if (v === undefined)\n            return this._randomizationFactor;\n        this._randomizationFactor = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setJitter(v);\n        return this;\n    }\n    reconnectionDelayMax(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelayMax;\n        this._reconnectionDelayMax = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMax(v);\n        return this;\n    }\n    timeout(v) {\n        if (!arguments.length)\n            return this._timeout;\n        this._timeout = v;\n        return this;\n    }\n    /**\n     * Starts trying to reconnect if reconnection is enabled and we have not\n     * started reconnecting yet\n     *\n     * @private\n     */\n    maybeReconnectOnOpen() {\n        // Only try to reconnect if it's the first time we're connecting\n        if (!this._reconnecting &&\n            this._reconnection &&\n            this.backoff.attempts === 0) {\n            // keeps reconnection from firing twice for the same reconnection loop\n            this.reconnect();\n        }\n    }\n    /**\n     * Sets the current transport `socket`.\n     *\n     * @param {Function} fn - optional, callback\n     * @return self\n     * @public\n     */\n    open(fn) {\n        if (~this._readyState.indexOf(\"open\"))\n            return this;\n        this.engine = new Engine(this.uri, this.opts);\n        const socket = this.engine;\n        const self = this;\n        this._readyState = \"opening\";\n        this.skipReconnect = false;\n        // emit `open`\n        const openSubDestroy = on(socket, \"open\", function () {\n            self.onopen();\n            fn && fn();\n        });\n        const onError = (err) => {\n            this.cleanup();\n            this._readyState = \"closed\";\n            this.emitReserved(\"error\", err);\n            if (fn) {\n                fn(err);\n            }\n            else {\n                // Only do this if there is no fn to handle the error\n                this.maybeReconnectOnOpen();\n            }\n        };\n        // emit `error`\n        const errorSub = on(socket, \"error\", onError);\n        if (false !== this._timeout) {\n            const timeout = this._timeout;\n            // set timer\n            const timer = this.setTimeoutFn(() => {\n                openSubDestroy();\n                onError(new Error(\"timeout\"));\n                socket.close();\n            }, timeout);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n        this.subs.push(openSubDestroy);\n        this.subs.push(errorSub);\n        return this;\n    }\n    /**\n     * Alias for open()\n     *\n     * @return self\n     * @public\n     */\n    connect(fn) {\n        return this.open(fn);\n    }\n    /**\n     * Called upon transport open.\n     *\n     * @private\n     */\n    onopen() {\n        // clear old subs\n        this.cleanup();\n        // mark as open\n        this._readyState = \"open\";\n        this.emitReserved(\"open\");\n        // add new subs\n        const socket = this.engine;\n        this.subs.push(on(socket, \"ping\", this.onping.bind(this)), on(socket, \"data\", this.ondata.bind(this)), on(socket, \"error\", this.onerror.bind(this)), on(socket, \"close\", this.onclose.bind(this)), on(this.decoder, \"decoded\", this.ondecoded.bind(this)));\n    }\n    /**\n     * Called upon a ping.\n     *\n     * @private\n     */\n    onping() {\n        this.emitReserved(\"ping\");\n    }\n    /**\n     * Called with data.\n     *\n     * @private\n     */\n    ondata(data) {\n        try {\n            this.decoder.add(data);\n        }\n        catch (e) {\n            this.onclose(\"parse error\", e);\n        }\n    }\n    /**\n     * Called when parser fully decodes a packet.\n     *\n     * @private\n     */\n    ondecoded(packet) {\n        // the nextTick call prevents an exception in a user-provided event listener from triggering a disconnection due to a \"parse error\"\n        nextTick(() => {\n            this.emitReserved(\"packet\", packet);\n        }, this.setTimeoutFn);\n    }\n    /**\n     * Called upon socket error.\n     *\n     * @private\n     */\n    onerror(err) {\n        this.emitReserved(\"error\", err);\n    }\n    /**\n     * Creates a new socket for the given `nsp`.\n     *\n     * @return {Socket}\n     * @public\n     */\n    socket(nsp, opts) {\n        let socket = this.nsps[nsp];\n        if (!socket) {\n            socket = new Socket(this, nsp, opts);\n            this.nsps[nsp] = socket;\n        }\n        else if (this._autoConnect && !socket.active) {\n            socket.connect();\n        }\n        return socket;\n    }\n    /**\n     * Called upon a socket close.\n     *\n     * @param socket\n     * @private\n     */\n    _destroy(socket) {\n        const nsps = Object.keys(this.nsps);\n        for (const nsp of nsps) {\n            const socket = this.nsps[nsp];\n            if (socket.active) {\n                return;\n            }\n        }\n        this._close();\n    }\n    /**\n     * Writes a packet.\n     *\n     * @param packet\n     * @private\n     */\n    _packet(packet) {\n        const encodedPackets = this.encoder.encode(packet);\n        for (let i = 0; i < encodedPackets.length; i++) {\n            this.engine.write(encodedPackets[i], packet.options);\n        }\n    }\n    /**\n     * Clean up transport subscriptions and packet buffer.\n     *\n     * @private\n     */\n    cleanup() {\n        this.subs.forEach((subDestroy) => subDestroy());\n        this.subs.length = 0;\n        this.decoder.destroy();\n    }\n    /**\n     * Close the current socket.\n     *\n     * @private\n     */\n    _close() {\n        this.skipReconnect = true;\n        this._reconnecting = false;\n        this.onclose(\"forced close\");\n        if (this.engine)\n            this.engine.close();\n    }\n    /**\n     * Alias for close()\n     *\n     * @private\n     */\n    disconnect() {\n        return this._close();\n    }\n    /**\n     * Called upon engine close.\n     *\n     * @private\n     */\n    onclose(reason, description) {\n        this.cleanup();\n        this.backoff.reset();\n        this._readyState = \"closed\";\n        this.emitReserved(\"close\", reason, description);\n        if (this._reconnection && !this.skipReconnect) {\n            this.reconnect();\n        }\n    }\n    /**\n     * Attempt a reconnection.\n     *\n     * @private\n     */\n    reconnect() {\n        if (this._reconnecting || this.skipReconnect)\n            return this;\n        const self = this;\n        if (this.backoff.attempts >= this._reconnectionAttempts) {\n            this.backoff.reset();\n            this.emitReserved(\"reconnect_failed\");\n            this._reconnecting = false;\n        }\n        else {\n            const delay = this.backoff.duration();\n            this._reconnecting = true;\n            const timer = this.setTimeoutFn(() => {\n                if (self.skipReconnect)\n                    return;\n                this.emitReserved(\"reconnect_attempt\", self.backoff.attempts);\n                // check again for the case socket closed in above events\n                if (self.skipReconnect)\n                    return;\n                self.open((err) => {\n                    if (err) {\n                        self._reconnecting = false;\n                        self.reconnect();\n                        this.emitReserved(\"reconnect_error\", err);\n                    }\n                    else {\n                        self.onreconnect();\n                    }\n                });\n            }, delay);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n    }\n    /**\n     * Called upon successful reconnect.\n     *\n     * @private\n     */\n    onreconnect() {\n        const attempt = this.backoff.attempts;\n        this._reconnecting = false;\n        this.backoff.reset();\n        this.emitReserved(\"reconnect\", attempt);\n    }\n}\n","import { url } from \"./url.js\";\nimport { Manager } from \"./manager.js\";\nimport { Socket } from \"./socket.js\";\n/**\n * Managers cache.\n */\nconst cache = {};\nfunction lookup(uri, opts) {\n    if (typeof uri === \"object\") {\n        opts = uri;\n        uri = undefined;\n    }\n    opts = opts || {};\n    const parsed = url(uri, opts.path || \"/socket.io\");\n    const source = parsed.source;\n    const id = parsed.id;\n    const path = parsed.path;\n    const sameNamespace = cache[id] && path in cache[id][\"nsps\"];\n    const newConnection = opts.forceNew ||\n        opts[\"force new connection\"] ||\n        false === opts.multiplex ||\n        sameNamespace;\n    let io;\n    if (newConnection) {\n        io = new Manager(source, opts);\n    }\n    else {\n        if (!cache[id]) {\n            cache[id] = new Manager(source, opts);\n        }\n        io = cache[id];\n    }\n    if (parsed.query && !opts.query) {\n        opts.query = parsed.queryKey;\n    }\n    return io.socket(parsed.path, opts);\n}\n// so that \"lookup\" can be used both as a function (e.g. `io(...)`) and as a\n// namespace (e.g. `io.connect(...)`), for backward compatibility\nObject.assign(lookup, {\n    Manager,\n    Socket,\n    io: lookup,\n    connect: lookup,\n});\n/**\n * Protocol version.\n *\n * @public\n */\nexport { protocol } from \"socket.io-parser\";\n/**\n * Expose constructors for standalone build.\n *\n * @public\n */\nexport { Manager, Socket, lookup as io, lookup as connect, lookup as default, };\n","import { parse } from \"engine.io-client\";\n/**\n * URL parser.\n *\n * @param uri - url\n * @param path - the request path of the connection\n * @param loc - An object meant to mimic window.location.\n *        Defaults to window.location.\n * @public\n */\nexport function url(uri, path = \"\", loc) {\n    let obj = uri;\n    // default to window.location\n    loc = loc || (typeof location !== \"undefined\" && location);\n    if (null == uri)\n        uri = loc.protocol + \"//\" + loc.host;\n    // relative path support\n    if (typeof uri === \"string\") {\n        if (\"/\" === uri.charAt(0)) {\n            if (\"/\" === uri.charAt(1)) {\n                uri = loc.protocol + uri;\n            }\n            else {\n                uri = loc.host + uri;\n            }\n        }\n        if (!/^(https?|wss?):\\/\\//.test(uri)) {\n            if (\"undefined\" !== typeof loc) {\n                uri = loc.protocol + \"//\" + uri;\n            }\n            else {\n                uri = \"https://\" + uri;\n            }\n        }\n        // parse\n        obj = parse(uri);\n    }\n    // make sure we treat `localhost:80` and `localhost` equally\n    if (!obj.port) {\n        if (/^(http|ws)$/.test(obj.protocol)) {\n            obj.port = \"80\";\n        }\n        else if (/^(http|ws)s$/.test(obj.protocol)) {\n            obj.port = \"443\";\n        }\n    }\n    obj.path = obj.path || \"/\";\n    const ipv6 = obj.host.indexOf(\":\") !== -1;\n    const host = ipv6 ? \"[\" + obj.host + \"]\" : obj.host;\n    // define unique id\n    obj.id = obj.protocol + \"://\" + host + \":\" + obj.port + path;\n    // define href\n    obj.href =\n        obj.protocol +\n            \"://\" +\n            host +\n            (loc && loc.port === obj.port ? \"\" : \":\" + obj.port);\n    return obj;\n}\n"],"names":["SDPUtils","Math","random","toString","substring","localCName","generateIdentifier","splitLines","blob","trim","split","map","line","splitSections","part","index","getDescription","sections","getMediaSections","shift","matchPrefix","prefix","filter","indexOf","parseCandidate","parts","candidate","foundation","component","protocol","toLowerCase","priority","parseInt","ip","address","port","type","i","length","relatedAddress","relatedPort","tcpType","ufrag","usernameFragment","undefined","writeCandidate","sdp","push","toUpperCase","join","parseIceOptions","parseRtpMap","parsed","payloadType","name","clockRate","channels","numChannels","writeRtpMap","codec","pt","preferredPayloadType","parseExtmap","id","direction","uri","attributes","slice","writeExtmap","headerExtension","preferredId","parseFmtp","kv","j","writeFmtp","parameters","Object","keys","params","forEach","param","parseRtcpFb","parameter","writeRtcpFb","lines","rtcpFeedback","fb","parseSsrcMedia","sp","ssrc","colon","attribute","value","parseSsrcGroup","semantics","ssrcs","getMid","mediaSection","mid","parseFingerprint","algorithm","getDtlsParameters","sessionpart","role","fingerprints","writeDtlsParameters","setupType","fp","parseCryptoLine","tag","cryptoSuite","keyParams","sessionParams","writeCryptoLine","writeCryptoKeyParams","parseCryptoKeyParams","keyMethod","keySalt","lifeTime","mkiValue","mkiLength","getCryptoParameters","getIceParameters","pwd","password","writeIceParameters","iceLite","parseRtpParameters","description","codecs","headerExtensions","fecMechanisms","rtcp","mline","profile","rtpmapline","fmtps","wildcardRtcpFb","find","existingFeedback","writeRtpDescription","kind","caps","maxptime","extension","parseRtpEncodingParameters","encodingParameters","hasRed","hasUlpfec","primarySsrc","secondarySsrc","flows","apt","encParam","codecPayloadType","rtx","JSON","parse","stringify","fec","mechanism","bandwidth","maxBitrate","parseRtcpParameters","rtcpParameters","remoteSsrc","obj","cname","rsize","reducedSize","compound","mux","writeRtcpParameters","parseMsid","spec","stream","track","planB","msidParts","parseSctpDescription","parseMLine","maxSizeLine","maxMessageSize","isNaN","sctpPort","fmt","sctpMapLines","writeSctpDescription","media","sctp","output","generateSessionId","substr","writeSessionBoilerplate","sessId","sessVer","sessUser","sessionId","version","getDirection","getKind","isRejected","parseOLine","username","sessionVersion","netType","addressType","isValidSDP","charAt","module","exports","logDisabled_","deprecationWarnings_","extractVersion","uastring","expr","pos","match","wrapPeerConnectionEvent","window","eventNameToWrap","wrapper","RTCPeerConnection","proto","prototype","nativeAddEventListener","addEventListener","nativeEventName","cb","apply","this","arguments","wrappedCallback","e","modifiedEvent","handleEvent","_eventMap","Map","set","nativeRemoveEventListener","removeEventListener","has","unwrappedCb","get","delete","size","defineProperty","enumerable","configurable","disableLog","bool","Error","disableWarnings","log","console","deprecated","oldMethod","newMethod","warn","isObject","val","call","compactObject","data","reduce","accumulator","key","isObj","isEmptyObject","assign","walkStats","stats","base","resultSet","endsWith","filterStats","result","outbound","streamStatsType","filteredResult","trackStats","trackIdentifier","trackStat","trackId","logging","utils","shimGetUserMedia","browserDetails","navigator","mediaDevices","constraintsToChrome_","c","mandatory","optional","cc","r","ideal","exact","min","max","oldname_","oc","mix","advanced","concat","shimConstraints_","constraints","func","audio","remap","a","b","video","face","facingMode","getSupportedFacingModeLies","getSupportedConstraints","matches","enumerateDevices","then","devices","dev","d","some","label","includes","deviceId","shimError_","PermissionDeniedError","PermissionDismissedError","InvalidStateError","DevicesNotFoundError","ConstraintNotSatisfiedError","TrackStartError","MediaDeviceFailedDueToShutdown","MediaDeviceKillSwitchOn","TabCaptureError","ScreenCaptureError","DeviceCaptureError","message","constraint","constraintName","getUserMedia","onSuccess","onError","webkitGetUserMedia","bind","origGetUserMedia","cs","getAudioTracks","getVideoTracks","getTracks","stop","DOMException","Promise","reject","shimGetDisplayMedia","getSourceId","getDisplayMedia","sourceId","widthSpecified","width","heightSpecified","height","frameRateSpecified","frameRate","chromeMediaSource","chromeMediaSourceId","maxFrameRate","maxWidth","maxHeight","error","shimMediaStream","MediaStream","webkitMediaStream","shimOnTrack","_ontrack","f","origSetRemoteDescription","setRemoteDescription","_ontrackpoly","te","receiver","getReceivers","event","Event","transceiver","streams","dispatchEvent","shimGetSendersWithDtmf","shimSenderWithDtmf","pc","dtmf","_dtmf","createDTMFSender","_pc","getSenders","_senders","origAddTrack","addTrack","sender","origRemoveTrack","removeTrack","idx","splice","origAddStream","addStream","origRemoveStream","removeStream","s","RTCRtpSender","origGetSenders","senders","shimGetStats","origGetStats","getStats","selector","onSucc","onErr","fixChromeStats_","response","standardReport","report","standardStats","timestamp","localcandidate","remotecandidate","names","stat","makeMapStats","successCallbackWrapper_","resolve","shimSenderReceiverGetStats","RTCRtpReceiver","origGetReceivers","receivers","srcElement","MediaStreamTrack","err","shimAddTrackRemoveTrackWithNative","getLocalStreams","_shimmedLocalStreams","streamId","existingSenders","newSenders","newSender","shimAddTrackRemoveTrack","origGetLocalStreams","nativeStreams","_reverseStreams","_streams","newStream","replaceInternalStreamId","internalId","externalStream","internalStream","replace","RegExp","RTCSessionDescription","signalingState","t","oldStream","method","nativeMethod","methodObj","args","desc","origSetLocalDescription","setLocalDescription","replaceExternalStreamId","origLocalDescription","getOwnPropertyDescriptor","streamid","shimPeerConnection","webkitRTCPeerConnection","RTCIceCandidate","fixNegotiationNeeded","target","getConfiguration","sdpSemantics","nativeGetUserMedia","getSettings","nativeGetSettings","applyConstraints","nativeApplyConstraints","preferredMediaSource","code","mediaSource","RTCTrackEvent","mozRTCPeerConnection","modernStatsTypes","inboundrtp","outboundrtp","candidatepair","nativeGetStats","shimSenderGetStats","shimReceiverGetStats","shimRemoveStream","shimRTCDataChannel","DataChannel","RTCDataChannel","shimAddTransceiver","origAddTransceiver","addTransceiver","setParametersPromises","sendEncodings","shouldPerformCheck","encodingParam","test","rid","TypeError","parseFloat","scaleResolutionDownBy","RangeError","maxFramerate","getParameters","encodings","setParameters","catch","shimGetParameters","origGetParameters","shimCreateOffer","origCreateOffer","createOffer","all","finally","shimCreateAnswer","origCreateAnswer","createAnswer","shimLocalStreamsAPI","_localStreams","_addTrack","_len","Array","_key","tracks","shimRemoteStreamsAPI","getRemoteStreams","_remoteStreams","_onaddstream","_onaddstreampoly","shimCallbacksAPI","addIceCandidate","successCallback","failureCallback","options","promise","withCallback","_getUserMedia","shimConstraints","errcb","shimRTCIceServerUrls","OrigPeerConnection","pcConfig","pcConstraints","iceServers","newIceServers","server","urls","url","generateCertificate","shimTrackEventTransceiver","shimCreateOfferLegacy","offerOptions","offerToReceiveAudio","audioTransceiver","getTransceivers","setDirection","offerToReceiveVideo","videoTransceiver","shimAudioContext","AudioContext","webkitAudioContext","shimRTCIceCandidate","NativeRTCIceCandidate","nativeCandidate","parsedCandidate","toJSON","sdpMid","sdpMLineIndex","writable","shimRTCIceCandidateRelayProtocol","relayProtocol","shimMaxMessageSize","_sctp","browser","mLine","sctpInDescription","isFirefox","getRemoteFirefoxVersion","canSendMMS","remoteIsFirefox","canSendMaxMessageSize","getCanSendMaxMessageSize","remoteMMS","getMaxMessageSize","Number","POSITIVE_INFINITY","shimSendThrowTypeError","wrapDcSend","dc","origDataChannelSend","send","byteLength","readyState","origCreateDataChannel","createDataChannel","dataChannel","channel","shimConnectionState","completed","checking","iceConnectionState","_onconnectionstatechange","origMethod","_connectionstatechangepoly","_lastConnectionState","connectionState","newEvent","removeExtmapAllowMixed","nativeSRD","shimAddIceCandidateNullOrEmpty","nativeAddIceCandidate","shimParameterlessSetLocalDescription","nativeSetLocalDescription","shimChrome","shimFirefox","shimSafari","userAgent","mozGetUserMedia","isSecureContext","supportsUnifiedPlan","RTCRtpTransceiver","adapter","commonShim","chromeShim","browserShim","firefoxShim","safariShim","adapterFactory","PACKET_TYPES","create","PACKET_TYPES_REVERSE","ERROR_PACKET","withNativeBlob","Blob","withNativeArrayBuffer","ArrayBuffer","isView","buffer","encodePacket","_ref","supportsBinary","callback","encodeBlobAsBase64","fileReader","FileReader","onload","content","readAsDataURL","toArray","Uint8Array","byteOffset","TEXT_ENCODER","chars","lookup","charCodeAt","decodePacket","encodedPacket","binaryType","mapBinary","decodeBase64Packet","decoded","base64","encoded1","encoded2","encoded3","encoded4","bufferLength","len","p","arraybuffer","bytes","decode","SEPARATOR","String","fromCharCode","createPacketEncoderStream","TransformStream","transform","packet","controller","arrayBuffer","encoded","TextEncoder","encode","encodePacketToBinary","payloadLength","header","DataView","setUint8","view","setUint16","setBigUint64","BigInt","enqueue","TEXT_DECODER","totalLength","chunks","acc","chunk","concatChunks","Emitter","mixin","on","fn","_callbacks","once","off","removeListener","removeAllListeners","callbacks","emit","emitReserved","listeners","hasListeners","globalThisShim","self","Function","pick","attr","k","hasOwnProperty","NATIVE_SET_TIMEOUT","globalThis","setTimeout","NATIVE_CLEAR_TIMEOUT","clearTimeout","installTimerFunctions","opts","useNativeTimers","setTimeoutFn","clearTimeoutFn","TransportError","constructor","reason","context","super","Transport","query","socket","open","doOpen","close","doClose","onClose","packets","write","onOpen","onData","onPacket","details","pause","onPause","createUri","schema","_hostname","_port","path","_query","hostname","secure","encodedQuery","str","encodeURIComponent","alphabet","prev","seed","num","floor","yeast","now","Date","XMLHttpRequest","hasCORS","XHR","xdomain","empty","hasXHR2","responseType","Request","_a","xd","xhr","extraHeaders","setDisableHeaderCheck","setRequestHeader","cookieJar","addCookies","withCredentials","requestTimeout","timeout","onreadystatechange","parseCookies","status","onLoad","document","requestsCount","requests","cleanup","fromError","abort","responseText","attachEvent","unloadHandler","nextTick","WebSocket","MozWebSocket","isReactNative","product","transports","websocket","forceBase64","check","protocols","headers","ws","addEventListeners","onopen","autoUnref","_socket","unref","onclose","closeEvent","onmessage","ev","onerror","lastPacket","timestampRequests","timestampParam","b64","webtransport","WebTransport","transport","transportOptions","closed","ready","createBidirectionalStream","decoderStream","maxPayload","TextDecoder","state","expectedLength","isBinary","headerArray","getUint16","n","getUint32","pow","createPacketDecoderStream","MAX_SAFE_INTEGER","reader","readable","pipeThrough","getReader","encoderStream","pipeTo","writer","getWriter","read","done","sid","polling","location","isSSL","createCookieJar","poll","total","doPoll","decodePayload","encodedPayload","encodedPackets","decodedPacket","encodePayload","count","doWrite","request","req","xhrStatus","pollXhr","re","src","m","exec","source","host","authority","ipv6uri","pathNames","regx","queryKey","$0","$1","$2","Socket","writeBuffer","prevBufferLen","agent","upgrade","rememberUpgrade","addTrailingSlash","rejectUnauthorized","perMessageDeflate","threshold","closeOnBeforeunload","qs","qry","pairs","l","pair","decodeURIComponent","upgrades","pingInterval","pingTimeout","pingTimeoutTimer","beforeunloadEventListener","offlineEventListener","createTransport","EIO","priorWebsocketSuccess","setTransport","onDrain","probe","failed","onTransportOpen","msg","upgrading","flush","freezeTransport","onTransportClose","onupgrade","to","resetPingTimeout","onHandshake","sendPacket","filterUpgrades","getWritablePackets","payloadSize","utf8Length","ceil","compress","cleanupAndClose","waitForUpgrade","filteredUpgrades","withNativeFile","File","hasBinary","isArray","deconstructPacket","buffers","packetData","pack","_deconstructPacket","attachments","placeholder","_placeholder","newData","reconstructPacket","_reconstructPacket","RESERVED_EVENTS","PacketType","Encoder","replacer","EVENT","ACK","encodeAsString","encodeAsBinary","BINARY_EVENT","BINARY_ACK","nsp","deconstruction","unshift","Decoder","reviver","add","reconstructor","decodeString","isBinaryEvent","BinaryReconstructor","takeBinaryData","start","buf","next","payload","tryParse","isPayloadValid","CONNECT","DISCONNECT","CONNECT_ERROR","destroy","finishedReconstruction","reconPack","binData","freeze","connect","connect_error","disconnect","disconnecting","newListener","io","connected","recovered","receiveBuffer","sendBuffer","_queue","_queueSeq","ids","acks","flags","auth","_opts","_autoConnect","disconnected","subEvents","subs","onpacket","active","_readyState","_len2","_key2","retries","fromQueue","volatile","_addToQueue","ack","pop","_registerAckCallback","isTransportWritable","engine","notifyOutgoingListeners","_this","ackTimeout","timer","_len3","_key3","emitWithAck","_len4","_key4","withErr","arg1","arg2","_this2","tryCount","pending","_len5","responseArgs","_key5","_drainQueue","force","_packet","_sendConnectPacket","_pid","pid","offset","_lastOffset","onconnect","onevent","onack","ondisconnect","emitEvent","_anyListeners","listener","sent","_len6","_key6","emitBuffered","subDestroy","onAny","prependAny","offAny","listenersAny","onAnyOutgoing","_anyOutgoingListeners","prependAnyOutgoing","offAnyOutgoing","listenersAnyOutgoing","Backoff","ms","factor","jitter","attempts","duration","rand","deviation","reset","setMin","setMax","setJitter","Manager","nsps","reconnection","reconnectionAttempts","Infinity","reconnectionDelay","reconnectionDelayMax","randomizationFactor","backoff","_parser","parser","encoder","decoder","autoConnect","v","_reconnection","_reconnectionAttempts","_reconnectionDelay","_randomizationFactor","_reconnectionDelayMax","_timeout","maybeReconnectOnOpen","_reconnecting","reconnect","Engine","skipReconnect","openSubDestroy","errorSub","onping","ondata","ondecoded","_destroy","_close","delay","onreconnect","attempt","cache","loc","href","sameNamespace","forceNew","multiplex"],"sourceRoot":""}